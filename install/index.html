
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://mozilla.github.io/bedrock/install/">
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../l10n/">
      
      
      <link rel="icon" href="../images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>Install - Bedrock Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.a40c8224.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#install" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Bedrock Documentation" class="md-header__button md-logo" aria-label="Bedrock Documentation" data-md-component="logo">
      
  <img src="../images/mozilla-logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Bedrock Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Install
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/mozilla/bedrock" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    mozilla/bedrock
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Bedrock Documentation" class="md-nav__button md-logo" aria-label="Bedrock Documentation" data-md-component="logo">
      
  <img src="../images/mozilla-logo.svg" alt="logo">

    </a>
    Bedrock Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/mozilla/bedrock" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    mozilla/bedrock
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Install
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Install
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#install" class="md-nav__link">
    <span class="md-ellipsis">
      Installing Bedrock
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installing Bedrock">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installation-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Installation Methods
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installation Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#docker-installation" class="md-nav__link">
    <span class="md-ellipsis">
      Docker Installation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#local-installation" class="md-nav__link">
    <span class="md-ellipsis">
      Local Installation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-python-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Run the tests
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Run the tests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#docker" class="md-nav__link">
    <span class="md-ellipsis">
      Docker
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#local" class="md-nav__link">
    <span class="md-ellipsis">
      Local
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-a-local-server" class="md-nav__link">
    <span class="md-ellipsis">
      Run a local server
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Run a local server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#docker_1" class="md-nav__link">
    <span class="md-ellipsis">
      Docker
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#local_1" class="md-nav__link">
    <span class="md-ellipsis">
      Local
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prod-mode" class="md-nav__link">
    <span class="md-ellipsis">
      Prod Mode
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#documentation" class="md-nav__link">
    <span class="md-ellipsis">
      Documentation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#localization" class="md-nav__link">
    <span class="md-ellipsis">
      Localization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#feature-flipping-aka-switches-or-waffle-switches" class="md-nav__link">
    <span class="md-ellipsis">
      Feature Flipping (aka Switches, or waffle switches)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Feature Flipping (aka Switches, or waffle switches)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#defining-and-using-switches" class="md-nav__link">
    <span class="md-ellipsis">
      Defining and Using Switches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#locale-specific-switches" class="md-nav__link">
    <span class="md-ellipsis">
      Locale-Specific Switches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#managing-switches" class="md-nav__link">
    <span class="md-ellipsis">
      Managing Switches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-switches-with-code" class="md-nav__link">
    <span class="md-ellipsis">
      Deploy switches with code
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-usage-in-templates" class="md-nav__link">
    <span class="md-ellipsis">
      Example Usage in Templates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-usage-in-python" class="md-nav__link">
    <span class="md-ellipsis">
      Example Usage in Python
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing" class="md-nav__link">
    <span class="md-ellipsis">
      Testing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#traffic-cop" class="md-nav__link">
    <span class="md-ellipsis">
      Traffic Cop
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../l10n/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Localization
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../coding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developing on Bedrock
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../browser-support/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Browser Support
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contribute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to Contribute
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../pipeline/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Continuous Integration & Deployment
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../testing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Front-end testing
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../task-queue/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Task Queue
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../redirects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Managing redirects
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../newsletters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Newsletters
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../legal-docs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Legal Docs
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Content Management System
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../sitemap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sitemaps
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../banners/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Banners
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../uitour/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mozilla.UITour
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../send-to-device/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Send to Device widget
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../download-buttons/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Firefox Download Buttons
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../mozilla-accounts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mozilla account helpers
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../abtest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A/B Testing
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../vpn-subscriptions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mozilla VPN Subscriptions
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_22" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../attribution/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Attribution
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_22" id="__nav_22_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_22_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_22">
            <span class="md-nav__icon md-icon"></span>
            Attribution
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../attribution/0001-analytics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mozorg Analytics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../attribution/0002-firefox-desktop/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Firefox Desktop attribution
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../attribution/0003-firefox-mobile/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Firefox Mobile attribution
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../attribution/0004-mozilla-accounts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mozilla accounts attribution
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../attribution/0005-affiliate-marketing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mozilla CJMS Affiliate attribution
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../attribution/0006-consent-management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Managing Data Privacy and Concent
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_23" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../architecture/decisions/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Architectural Decision Records
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_23" id="__nav_23_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_23_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_23">
            <span class="md-nav__icon md-icon"></span>
            Architectural Decision Records
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0001-record-architecture-decisions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. Record architecture decisions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0002-move-ci-cd-pipelines-to-gitlab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Move CI/CD Pipelines to Gitlab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0003-use-cloudflare-workers-and-convert-for-multi-variant-testing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Use Cloudflare Workers and Convert for multi-variant testing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0004-use-fluent-for-localization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Use Fluent For Localization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0005-use-a-single-docker-image-for-all-deployments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. Use a Single Docker Image For All Deployments
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0006-revise-tooling-for-python-dependency-management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. Revise tooling for Python dependency management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0007-further-revise-tooling-for-python-dependency-management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7. Further revise tooling for Python dependency management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0008-move-demos-to-gcp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    8. Move Demos To GCP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0009-use-manage-contentful-migrations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    9. Manage Contentful schema state via migrations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0010-move-ci-cd-to-github-actions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    10. Move CI to Github Actions for Unit and Integration tests
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0011-use-statsd-for-metrics-collection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    11. Use StatsD for metrics collection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0012-wagtail-for-cms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    12. Use Wagtail CMS
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contentful/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contentful (deprecated)
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../content-cards/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    External Content Cards (deprecated)
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#install" class="md-nav__link">
    <span class="md-ellipsis">
      Installing Bedrock
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installing Bedrock">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installation-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Installation Methods
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installation Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#docker-installation" class="md-nav__link">
    <span class="md-ellipsis">
      Docker Installation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#local-installation" class="md-nav__link">
    <span class="md-ellipsis">
      Local Installation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-python-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Run the tests
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Run the tests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#docker" class="md-nav__link">
    <span class="md-ellipsis">
      Docker
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#local" class="md-nav__link">
    <span class="md-ellipsis">
      Local
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-a-local-server" class="md-nav__link">
    <span class="md-ellipsis">
      Run a local server
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Run a local server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#docker_1" class="md-nav__link">
    <span class="md-ellipsis">
      Docker
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#local_1" class="md-nav__link">
    <span class="md-ellipsis">
      Local
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prod-mode" class="md-nav__link">
    <span class="md-ellipsis">
      Prod Mode
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#documentation" class="md-nav__link">
    <span class="md-ellipsis">
      Documentation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#localization" class="md-nav__link">
    <span class="md-ellipsis">
      Localization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#feature-flipping-aka-switches-or-waffle-switches" class="md-nav__link">
    <span class="md-ellipsis">
      Feature Flipping (aka Switches, or waffle switches)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Feature Flipping (aka Switches, or waffle switches)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#defining-and-using-switches" class="md-nav__link">
    <span class="md-ellipsis">
      Defining and Using Switches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#locale-specific-switches" class="md-nav__link">
    <span class="md-ellipsis">
      Locale-Specific Switches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#managing-switches" class="md-nav__link">
    <span class="md-ellipsis">
      Managing Switches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-switches-with-code" class="md-nav__link">
    <span class="md-ellipsis">
      Deploy switches with code
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-usage-in-templates" class="md-nav__link">
    <span class="md-ellipsis">
      Example Usage in Templates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-usage-in-python" class="md-nav__link">
    <span class="md-ellipsis">
      Example Usage in Python
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing" class="md-nav__link">
    <span class="md-ellipsis">
      Testing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#traffic-cop" class="md-nav__link">
    <span class="md-ellipsis">
      Traffic Cop
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Install</h1>

<h2 id="install">Installing Bedrock<a class="headerlink" href="#install" title="Permanent link">&para;</a></h2>
<h3 id="installation-methods">Installation Methods<a class="headerlink" href="#installation-methods" title="Permanent link">&para;</a></h3>
<p>There are two primary methods of installing bedrock: Docker and Local. Whichever you choose, you'll start by getting the source.</p>
<p>The codebase lives at <a href="https://github.com/mozilla/bedrock/">https://github.com/mozilla/bedrock/</a></p>
<p>Only Mozilla staff have write access to that repository; community contributors do not, so should instead make a fork of the repo to work from. You will still be able to make pull requests from your fork into <code>mozilla/bedrock</code>.</p>
<p>Get the source code:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># If you&#39;re a Mozilla staff member with write access to the repo</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/mozilla/bedrock.git
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Or if you lack write access to the repo</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/YOUR_GITHUB_USERNAME_HERE/bedrock.git
</span></code></pre></div>
<p>Once the codebase is cloned, switch into it:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>bedrock
</span></code></pre></div>
<p>After these basic steps you can choose your install method below.</p>
<p>Docker is the easiest and recommended way, but local installation directly onto your machine is also possible and may be preferred, particularly if you're doing frontend work, which is currently slower when using Docker.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You should also install our git pre-commit hooks. These are checks that automatically run before a git commit is allowed. You don't have to do this in order to get bedrock running locally, but it's recommended to do before you start making contributions.</p>
<p>The Bedrock project uses the <a href="https://pre-commit.com/">pre-commit</a> framework that makes managing git hooks easier across all contributors by ensuring everyone has the same ones set up.</p>
<p>Install the framework by running <code>pip install pre-commit</code>, then - ensuring you are in your <code>bedrock</code> directory -run <code>pre-commit install</code> in your terminal, followed by <code>pre-commit install-hooks</code>. This will set up the hooks that are specified in <code>bedrock/.precommit.yaml</code></p>
<p>After that setup, whenever you try to make a commit, the 'hooks' will check/lint your Python, JS, and CSS files beforehand and report on problems that need to be fixed before the commit can be made. This will save you time waiting for the tests to run in our <code class="interpreted-text" role="abbr">CI (Continuous Integration)</code> before noticing a linting error.</p>
</div>
<h4 id="docker-installation">Docker Installation<a class="headerlink" href="#docker-installation" title="Permanent link">&para;</a></h4>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method assumes you have <a href="https://www.docker.com/">Docker installed for your platform</a>. If not please do that now or skip to the <code>Local Installation</code> section.</p>
</div>
<p>This is the simplest way to get started developing for bedrock. If you're on Linux or Mac (and possibly Windows 10 with the Linux subsystem) you can run a script that will pull our production and development docker images and start them:</p>
<div class="language-text highlight"><pre><span></span><code>$ make clean run
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can start the server any other time with:</p>
<div class="language-text highlight"><pre><span></span><code>$ make run
</code></pre></div>
</div>
<p>You should see a number of things happening, but when it's done it will output something saying that the server is running at <a href="http://localhost:8000/">localhost:8000</a>. Go to that URL in a browser and you should see the mozilla.org home page. In this mode the site will refresh itself when you make changes to any template or media file. Simply open your editor of choice and modify things and you should see those changes reflected in your browser.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It's a good idea to run <code>make pull</code> from time to time. This will pull down the latest Docker images from our repository ensuring that you have the latest dependencies installed among other things. If you see any strange errors after a <code>git pull</code> then <code>make pull</code> is a good thing to try for a quick fix.</p>
</div>
<p>If you don't have or want to use Make you can call the docker and compose commands directly</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>$<span class="w"> </span>docker<span class="w"> </span>compose<span class="w"> </span>pull
</span></code></pre></div>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>$<span class="w"> </span><span class="o">[[</span><span class="w"> </span>!<span class="w"> </span>-f<span class="w"> </span>.env<span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>cp<span class="w"> </span>.env-dist<span class="w"> </span>.env
</span></code></pre></div>
<p>Then starting it all is simply</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>$<span class="w"> </span>docker<span class="w"> </span>compose<span class="w"> </span>up<span class="w"> </span>app<span class="w"> </span>assets
</span></code></pre></div>
<p>All of this is handled by the <code>Makefile</code> script and called by Make if you follow the above directions. You <strong>DO NOT</strong> need to do both.</p>
<p>These directions pull and use the pre-built images that our deployment process has pushed to the <a href="https://hub.docker.com/u/mozorg/">Docker Hub</a>. If you need to add or change any dependencies for Python or Node then you'll need to build new images for local testing. You can do this by updating the requirements files and/or package.json file then simply running:</p>
<div class="language-text highlight"><pre><span></span><code>$ make build
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>For Apple Silicon / M1 users</strong></p>
<p>If you find that when you're building you hit issues compiling assets, try unchecking <code>Use Rosetta for x86_64/amd64 emulation on Apple Silicon</code> in the Docker Desktop settings.</p>
</div>
<p><strong>Asset bundles</strong></p>
<p>If you make a change to <code>media/static-bundles.json</code>, you'll need to restart Docker.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sometimes stopping Docker doesn't actually kill the images. To be safe, after stopping docker, run <code>docker ps</code> to ensure the containers were actually stopped. If they have not been stopped, you can force them by running <code>docker compose kill</code> to stop all containers, or <code>docker kill &lt;container_name&gt;</code> to stop a single container, e.g. <code>docker kill bedrock_app_1</code>.</p>
</div>
<h4 id="local-installation">Local Installation<a class="headerlink" href="#local-installation" title="Permanent link">&para;</a></h4>
<p>These instructions assume you have Python, pip, and NodeJS installed. If you don't have <code>pip</code> installed (you probably do) you can install it with the instructions in <a href="https://pip.pypa.io/en/stable/installing/">the pip docs</a>.</p>
<p>Bedrock currently uses Python 3.12.x. The recommended way to install and use that version is with <a href="https://github.com/pyenv/pyenv">pyenv</a> and to create a virtualenv using <a href="https://github.com/pyenv/pyenv-virtualenv">pyenv-virtualenv</a> that will isolate Bedrock's dependencies from other things installed on the system.</p>
<p>The following assumes you are on MacOS, using <code>zsh</code> as your shell and <a href="https://brew.sh/">Homebrew</a> as your package manager. If you are not, there are installation instructions for a variety of platforms and shells in the READMEs for the two pyenv projects.</p>
<p><strong>Install Python 3.12.x with pyenv</strong></p>
<ol>
<li>Install <code>pyenv</code> itself :<div class="language-text highlight"><pre><span></span><code>$ brew install pyenv
</code></pre></div>
</li>
</ol>
<p>2. Configure your shell to init <code>pyenv</code> on start - this is noted in the project's <a href="https://github.com/pyenv/pyenv">own docs</a>, in more detail, but omits that setting <code>PYENV_ROOT</code> and adding it to the path is needed:</p>
<div class="language-text highlight"><pre><span></span><code>$ echo &#39;export PYENV_ROOT=&quot;$HOME/.pyenv&quot;&#39; &gt;&gt; ~/.zshrc
$ echo &#39;export PATH=&quot;$PYENV_ROOT/bin:$PATH&quot;&#39; &gt;&gt; ~/.zshrc
$ echo &#39;eval &quot;$(pyenv init -)&quot;&#39; &gt;&gt; ~/.zshrc
</code></pre></div>
<p>3. Restart your login session for the changes to profile files to take effect - if you're not using <code>zsh</code>, the <code>pyenv</code> docs have other routes :</p>
<div class="language-text highlight"><pre><span></span><code>$ zsh -l
</code></pre></div>
<ol>
<li>
<p>Install the latest Python 3.12.x (e.g. 3.12.6), then test it's there:</p>
<div class="language-text highlight"><pre><span></span><code>$ pyenv install 3.12.6
</code></pre></div>
<p>If you'd like to make Python 3.12 your default globally, you can do so with:</p>
<div class="language-text highlight"><pre><span></span><code>$ pyenv global 3.12.6
</code></pre></div>
<p>If you only want to make Python 3.12 available in the current shell, while you set up the Python virtualenv (below), you can do so with:</p>
<div class="language-text highlight"><pre><span></span><code>$ pyenv shell 3.12.6
</code></pre></div>
</li>
<li>
<p>Verify that you have the correct version of Python installed:</p>
<div class="language-text highlight"><pre><span></span><code>$ python --version
Python 3.12.6
</code></pre></div>
</li>
</ol>
<p><strong>Install a plugin to manage virtualenvs via pyenv and create a virtualenv for Bedrock's dependencies</strong></p>
<ol>
<li>Install <code>pyenv-virtualenv</code> :<div class="language-text highlight"><pre><span></span><code>$ brew install pyenv-virtualenv
</code></pre></div>
</li>
</ol>
<p>2. Configure your shell to init <code>pyenv-virtualenv</code> on start - again, this is noted in the <code>pyenv-virtualenv</code> project's <a href="https://github.com/pyenv/pyenv-virtualenv">own documentation</a>, in more detail. The following will slot in a command that will work as long as you have pyenv-virtualenv installed:</p>
<div class="language-text highlight"><pre><span></span><code>$ echo &#39;eval &quot;$(pyenv virtualenv-init -)&quot;&#39; &gt;&gt; ~/.zshrc
</code></pre></div>
<ol>
<li>
<p>Restart your login session for the changes to profile files to take effect :</p>
<div class="language-text highlight"><pre><span></span><code>$ zsh -l
</code></pre></div>
</li>
<li>
<p>Make a virtualenv we can use - in this example we'll call it <code>bedrock</code> but use whatever you want :</p>
<div class="language-text highlight"><pre><span></span><code>$ pyenv virtualenv 3.12.6 bedrock
</code></pre></div>
</li>
</ol>
<p><strong>Use the virtualenv</strong></p>
<ol>
<li>Switch to the virtualenv - this is the command you will use any time you need this virtualenv :<div class="language-text highlight"><pre><span></span><code>$ pyenv activate bedrock
</code></pre></div>
</li>
</ol>
<p>2. If you'd like to auto activate the virtualenv when you cd into the bedrock directory, and deactivate it when you exit the directory, you can do so with:</p>
<div class="language-text highlight"><pre><span></span><code>$ echo &#39;bedrock&#39; &gt; .python-version
</code></pre></div>
<ol>
<li>
<p>Securely upgrade pip :</p>
<div class="language-text highlight"><pre><span></span><code>$ pip install --upgrade pip
</code></pre></div>
</li>
<li>
<p>Install / update Python dependencies :</p>
<div class="language-text highlight"><pre><span></span><code>$ make install-local-python-deps
</code></pre></div>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are on OSX and some of the compiled dependencies fails to compile, try explicitly setting the arch flags and try again. The following are relevant to Intel Macs only. If you're on Apple Silicon, 3.12.6 should 'just work':</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>$<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">ARCHFLAGS</span><span class="o">=</span><span class="s2">&quot;-arch i386 -arch x86_64&quot;</span>
</span></code></pre></div>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>$<span class="w"> </span>make<span class="w"> </span>install-local-python-deps
</span></code></pre></div>
<p>If you are on Linux, you may need at least the following packages or their equivalent for your distro:</p>
<div class="language-text highlight"><pre><span></span><code>python3-dev libxslt-dev
</code></pre></div>
</div>
<p><strong>Download a fresh copy of the sqlite database that Bedrock uses locally</strong> This contains product-details, security-advisories, credits, release notes, localizations, legal-docs etc. We also download the latest translations of site content in many languages:</p>
<div class="language-text highlight"><pre><span></span><code>$ bin/bootstrap.sh
</code></pre></div>
<p><strong>Install the node dependencies to run the site</strong>. This will only work if you already have <a href="https://nodejs.org/">Node.js</a> and <a href="https://www.npmjs.com/">npm</a> installed:</p>
<div class="language-text highlight"><pre><span></span><code>$ npm install
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Bedrock uses npm to ensure that Node.js packages that get installed are the exact ones we meant (similar to pip hash checking mode for python). Refer to the <a href="https://docs.npmjs.com/">npm documentation</a> for adding or upgrading Node.js dependencies.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As a convenience, there is a <code>make preflight</code> command which calls some of the commands above to bring your installed Python and NPM dependencies up to date and also fetches the latest DB containing the latest site content. This is a good thing to run after pulling in latest changes from the <code>main</code> branch.</p>
<p>IMPORTANT: if you do not want to replace your local DB with a fresher one, use <code>make preflight -- --retain-db</code> instead.</p>
<p>We also have an optional git hook that will alert you if <code>make preflight</code> needs to be run. You can install that with <code>make install-custom-git-hooks</code>.</p>
</div>
<h3 id="run-python-tests">Run the tests<a class="headerlink" href="#run-python-tests" title="Permanent link">&para;</a></h3>
<p>Now that we have everything installed, let's make sure all of our tests pass. This will be important during development so that you can easily know when you've broken something with a change.</p>
<h4 id="docker">Docker<a class="headerlink" href="#docker" title="Permanent link">&para;</a></h4>
<p>We manage our local docker environment with docker compose and Make. All you need to do here is run:</p>
<div class="language-text highlight"><pre><span></span><code>$ make test
</code></pre></div>
<p>If you don't have Make you can simply run <code>docker compose run test</code>.</p>
<p>If you'd like to run only a subset of the tests or only one of the test commands you can accomplish that with a command like the following:</p>
<div class="language-text highlight"><pre><span></span><code>$ docker compose run test pytest bedrock/firefox
</code></pre></div>
<p>This example will run only the unit tests for the <code>firefox</code> app in bedrock. You can substitute <code>pytest bedrock/firefox</code> with most any shell command you'd like and it will run in the Docker container and show you the output. You can also just run <code>bash</code> to get an interactive shell in the container which you can then use to run any commands you'd like and inspect the file system:</p>
<div class="language-text highlight"><pre><span></span><code>$ docker compose run test bash
</code></pre></div>
<h4 id="local">Local<a class="headerlink" href="#local" title="Permanent link">&para;</a></h4>
<p>From the local install instructions above you should still have your virtualenv activated, so running the tests is as simple as:</p>
<div class="language-text highlight"><pre><span></span><code>$ pytest lib bedrock
</code></pre></div>
<p>To test a single app, specify the app by name in the command above. e.g.:</p>
<div class="language-text highlight"><pre><span></span><code>$ pytest bedrock/firefox
</code></pre></div>
<h3 id="run-a-local-server">Run a local server<a class="headerlink" href="#run-a-local-server" title="Permanent link">&para;</a></h3>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Regardless of whether you run Bedrock via Docker or directly on your machine, the URL of the site is <code>http://localhost:8000</code> - <code>not</code> <code>8080</code></p>
</div>
<h4 id="docker_1">Docker<a class="headerlink" href="#docker_1" title="Permanent link">&para;</a></h4>
<p>You can simply run the <code>make run</code> script mentioned above, or use docker compose directly:</p>
<div class="language-text highlight"><pre><span></span><code>$ docker compose up app assets
</code></pre></div>
<h4 id="local_1">Local<a class="headerlink" href="#local_1" title="Permanent link">&para;</a></h4>
<p>To make the server run, make sure your virtualenv is activated with <code>pyenv activate bedrock</code>, and then run the server:</p>
<div class="language-text highlight"><pre><span></span><code>$ npm start
</code></pre></div>
<p>Wait for the server to start up and then browse to <a href="http://localhost:8000">http://localhost:8000</a></p>
<p>Congratulations, you should now have your own copy of <a href="http://www.mozilla.org">www.mozilla.org</a> running locally!</p>
<h4 id="prod-mode">Prod Mode<a class="headerlink" href="#prod-mode" title="Permanent link">&para;</a></h4>
<p>There are certain things about the site that behave differently when running locally in dev mode using Django's development server than they do when running in the way it runs in production. Static assets that work fine locally can be a problem in production if referenced improperly, and the normal error pages won't work unless <code>DEBUG=False</code> and doing that will make the site throw errors since the Django server doesn't have access to all of the built static assets. So we have a couple of extra Docker commands (via make) that you can use to run the site locally in a more prod-like way.</p>
<p>First you should ensure that your <code>.env</code> file is setup the way you need. This usually means adding <code>DEBUG=False</code> and <code>DEV=False</code>, though you may want <code>DEV=True</code> if you want the site to act more like www-dev.allizom.org in that all feature switches are <code>On</code> and all locales are active for every page. After that you can run the following:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>$<span class="w"> </span>make<span class="w"> </span>run-prod
</span></code></pre></div>
<p>This will run the latest bedrock image using your local bedrock files and templates, but not your local static assets. If you need an updated image just run <code>make pull</code>.</p>
<p>If you need to include the changes you've made to your local static files (images, css, js, etc.) then you have to build the image first:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>$<span class="w"> </span>make<span class="w"> </span>build-prod<span class="w"> </span>run-prod
</span></code></pre></div>
<h4 id="documentation">Documentation<a class="headerlink" href="#documentation" title="Permanent link">&para;</a></h4>
<p>This is a great place for coders and non-coders alike to contribute! Please note most of the documentation is currently in <a href="https://bashtage.github.io/sphinx-material/basics.html">reStructuredText</a> but we also support <a href="https://www.markdownguide.org/">Markdown</a> files.</p>
<p>If you see a typo or similarly small change, you can use the "Edit in GitHub" link to propose a fix through GitHub. Note: you will not see your change directly committed to the main branch. You will commit the change to a separate branch so it can be reviewed by a staff member before merging to main.</p>
<p>If you want to make a bigger change or <a href="https://github.com/mozilla/bedrock/labels/Documentation">find a Documentation issue on the repo</a>, it is best to edit and preview locally before submitting a pull request. You can do this with Docker or Local installations. Run the commands from your root folder. They will build documentation and start a live server to auto-update any changes you make to a documentation file.</p>
<p>Docker:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>$<span class="w"> </span>make<span class="w"> </span>docs
</span></code></pre></div>
<p>Local:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>$<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements/docs.txt
</span></code></pre></div>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>$<span class="w"> </span>make<span class="w"> </span>livedocs
</span></code></pre></div>
<h3 id="localization">Localization<a class="headerlink" href="#localization" title="Permanent link">&para;</a></h3>
<p>Localization (or L10n) files were fetched by the <code>bootstrap.sh</code> command your ran earlier and are included in the docker images. If you need to update them or switch to a different repo or branch after changing settings you can run the following command:</p>
<div class="language-text highlight"><pre><span></span><code>$ ./manage.py l10n_update
</code></pre></div>
<p>You can read more details about how to localize content <a href="../l10n/">here</a>.</p>
<h3 id="feature-flipping-aka-switches-or-waffle-switches">Feature Flipping (aka Switches, or waffle switches)<a class="headerlink" href="#feature-flipping-aka-switches-or-waffle-switches" title="Permanent link">&para;</a></h3>
<p>Switches are managed using django-waffle and are stored in the database. These switches control behavior and/or features of select pages on Bedrock, and their state (active or inactive) is based on an <code>active</code> boolean field in the database.</p>
<h4 id="defining-and-using-switches">Defining and Using Switches<a class="headerlink" href="#defining-and-using-switches" title="Permanent link">&para;</a></h4>
<p>The <code>switch()</code> template helper function allows you to check whether a specific switch is active. You pass a name to the function (using only letters, numbers, and dashes), which is automatically converted to uppercase and with dashes replaced by underscores for the lookup in the database. For example, <code>switch('the-dude')</code> will look for a switch named <code>THE_DUDE</code> in the database.</p>
<h4 id="locale-specific-switches">Locale-Specific Switches<a class="headerlink" href="#locale-specific-switches" title="Permanent link">&para;</a></h4>
<p>You can provide a list of locale codes to limit the switch's activation to specific locales. If the page is viewed in a locale not included in the list, the switch will return False. You can also use "Locale Groups," which apply to all locales with a common prefix (e.g., "en-US, en-GB" or "zh-CN, zh-TW"). To use these groups, pass the prefix. For example, <code>switch('the-dude', ['en', 'de'])</code> will activate the switch for German and any English locale supported by the site.</p>
<h4 id="managing-switches">Managing Switches<a class="headerlink" href="#managing-switches" title="Permanent link">&para;</a></h4>
<p>Switches are managed through the Django Admin interface, where you can add, edit, or remove switches from the database directly. This interface allows for easy management of feature toggles without modifying environment variables or code. There is also a Django management command to toggle switches from the command line, as detailed below.</p>
<h4 id="deploy-switches-with-code">Deploy switches with code<a class="headerlink" href="#deploy-switches-with-code" title="Permanent link">&para;</a></h4>
<p>You can deploy switches directly through code by creating a data migration. This approach ensures switches are consistently created or updated during deployment, rather than requiring manual configuration through the Django Admin interface.</p>
<p>To implement a switch via data migration, create an empty migration file:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>./manage.py<span class="w"> </span>makemigrations<span class="w"> </span>base<span class="w"> </span>--empty
</span></code></pre></div>
<p>Then add the following code to the generated migration file, which can be found in the <code>bedrock/base/migrations</code> directory:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.db</span><span class="w"> </span><span class="kn">import</span> <span class="n">migrations</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">waffle.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Switch</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="c1"># The name of the switch must be unique.</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="n">SWITCH_NAME</span> <span class="o">=</span> <span class="s2">&quot;RELEASE_THE_KRAKEN&quot;</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_switch</span><span class="p">(</span><span class="n">apps</span><span class="p">,</span> <span class="n">schema_editor</span><span class="p">):</span>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a>    <span class="n">Switch</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get_or_create</span><span class="p">(</span>
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>        <span class="n">name</span><span class="o">=</span><span class="n">SWITCH_NAME</span><span class="p">,</span>
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a>        <span class="n">defaults</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;active&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>  <span class="c1"># Set initial state, True or False.</span>
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a>    <span class="p">)</span>
</span><span id="__span-13-14"><a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a>
</span><span id="__span-13-15"><a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a>
</span><span id="__span-13-16"><a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a><span class="k">def</span><span class="w"> </span><span class="nf">remove_switch</span><span class="p">(</span><span class="n">apps</span><span class="p">,</span> <span class="n">schema_editor</span><span class="p">):</span>
</span><span id="__span-13-17"><a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a>    <span class="n">Switch</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">SWITCH_NAME</span><span class="p">)</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</span><span id="__span-13-18"><a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a>
</span><span id="__span-13-19"><a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a>
</span><span id="__span-13-20"><a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a><span class="k">class</span><span class="w"> </span><span class="nc">Migration</span><span class="p">(</span><span class="n">migrations</span><span class="o">.</span><span class="n">Migration</span><span class="p">):</span>
</span><span id="__span-13-21"><a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a>    <span class="n">dependencies</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-13-22"><a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a>        <span class="p">(</span>
</span><span id="__span-13-23"><a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a>            <span class="s2">&quot;base&quot;</span><span class="p">,</span>
</span><span id="__span-13-24"><a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a>            <span class="s2">&quot;0001_initial&quot;</span><span class="p">,</span>
</span><span id="__span-13-25"><a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a>        <span class="p">),</span>  <span class="c1"># Keep whatever the makemigrations command generated here.</span>
</span><span id="__span-13-26"><a id="__codelineno-13-26" name="__codelineno-13-26" href="#__codelineno-13-26"></a>    <span class="p">]</span>
</span><span id="__span-13-27"><a id="__codelineno-13-27" name="__codelineno-13-27" href="#__codelineno-13-27"></a>
</span><span id="__span-13-28"><a id="__codelineno-13-28" name="__codelineno-13-28" href="#__codelineno-13-28"></a>    <span class="n">operations</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-13-29"><a id="__codelineno-13-29" name="__codelineno-13-29" href="#__codelineno-13-29"></a>        <span class="n">migrations</span><span class="o">.</span><span class="n">RunPython</span><span class="p">(</span><span class="n">create_switch</span><span class="p">,</span> <span class="n">remove_switch</span><span class="p">),</span>
</span><span id="__span-13-30"><a id="__codelineno-13-30" name="__codelineno-13-30" href="#__codelineno-13-30"></a>    <span class="p">]</span>
</span></code></pre></div>
<p>The migration will run during deployment and ensure the switch exists in the database. The <code>remove_switch</code> function allows the migration to be reversed if needed.</p>
<p>To test this locally, run the following command:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>./manage.py<span class="w"> </span>migrate<span class="w"> </span>base
</span></code></pre></div>
<p>Verify the switch exists in the database by running:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>./manage.py<span class="w"> </span>waffle_switch<span class="w"> </span>-l
</span></code></pre></div>
<p>You should see the switch listed in the output.</p>
<p>To test reversing the migration, run the following command but replace <code>0001</code> with whatever the previous migration number is:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>./manage.py<span class="w"> </span>migrate<span class="w"> </span>base<span class="w"> </span><span class="m">0001</span>
</span></code></pre></div>
<h4 id="example-usage-in-templates">Example Usage in Templates<a class="headerlink" href="#example-usage-in-templates" title="Permanent link">&para;</a></h4>
<p>You can use the <code>switch()</code> helper function in your templates as follows:</p>
<div class="language-html highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>{% if switch(&#39;the-dude&#39;) %}
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>    <span class="cm">&lt;!-- Feature-specific HTML goes here --&gt;</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>{% endif %}
</span></code></pre></div>
<h4 id="example-usage-in-python">Example Usage in Python<a class="headerlink" href="#example-usage-in-python" title="Permanent link">&para;</a></h4>
<p>You may also use switches in Python code (though locale support is unavailable in this context):</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Avoid using switch() outside the request/response cycle</strong> (e.g., during module-level imports or in a urls.py file), as the switch's state is managed in the database and can be changed via the admin interface. Using it outside the request cycle would prevent the switch value from reflecting real-time updates.</p>
</div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">bedrock.base.waffle</span><span class="w"> </span><span class="kn">import</span> <span class="n">switch</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">home_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>    <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Staging Home&quot;</span> <span class="k">if</span> <span class="n">switch</span><span class="p">(</span><span class="s2">&quot;staging-site&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;Prod Home&quot;</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>    <span class="o">...</span>
</span></code></pre></div>
<h4 id="testing">Testing<a class="headerlink" href="#testing" title="Permanent link">&para;</a></h4>
<p>If the environment variable <code>DEV</code> is set to a "true" value, then all switches will be considered active unless they are explicitly set as not active in the database. <code>DEV</code> defaults to "true" in local development and demo servers.</p>
<p>To test switches locally, add the switch to the database. This can be done in one of two ways.</p>
<ol>
<li>
<p>Add the switch via the Django management command:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>./manage.py<span class="w"> </span>waffle_switch<span class="w"> </span>--create<span class="w"> </span>SWITCH_NAME<span class="w"> </span>on
</span></code></pre></div>
<p>If the switch already exists, you can toggle it using:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>./manage.py<span class="w"> </span>waffle_switch<span class="w"> </span>SWITCH_NAME<span class="w"> </span>on<span class="w"> </span>./manage.py<span class="w"> </span>waffle_switch<span class="w"> </span>SWITCH_NAME<span class="w"> </span>off
</span></code></pre></div>
<p>And you can view all the switches via:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>./manage.py<span class="w"> </span>waffle_switch<span class="w"> </span>-l
</span></code></pre></div>
<p>To delete a switch, run:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>./manage.py<span class="w"> </span>waffle_delete<span class="w"> </span>--switches<span class="w"> </span>SWITCH_NAME
</span></code></pre></div>
</li>
<li>
<p>Add the switch in the Django admin at <code>/django-admin/</code>. There you will see the "Django-Waffle" module with the "Switches" table. Click through to view the switches and add/edit/delete as needed.</p>
</li>
</ol>
<h4 id="traffic-cop">Traffic Cop<a class="headerlink" href="#traffic-cop" title="Permanent link">&para;</a></h4>
<p>Currently, these switches are used to enable/disable <a href="https://github.com/mozmeao/trafficcop/">Traffic Cop</a> experiments on many pages of the site. We only add the Traffic Cop JavaScript snippet to a page when there is an active test.</p>
<p>To work with/test these experiment switches locally, you must add the switches to your local database.</p>
<h4 id="notes">Notes<a class="headerlink" href="#notes" title="Permanent link">&para;</a></h4>
<p>A shortcut for activating virtual envs in zsh or bash is <code>. venv/bin/activate</code>. The dot is the same as <code>source</code>.</p>
<p>There's a project called <a href="https://pypi.org/project/pew/">pew</a> that provides a better interface for managing/activating virtual envs, so you can use that if you want. Also if you need help managing various versions of Python on your system, the <a href="https://github.com/pyenv/pyenv">pyenv</a> project can help.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href=".." class="md-footer__link md-footer__link--prev" aria-label="Previous: Home">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Home
              </div>
            </div>
          </a>
        
        
          
          <a href="../l10n/" class="md-footer__link md-footer__link--next" aria-label="Next: Localization">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Localization
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
       Copyright 2011-2025, Mozilla
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/mozilla/bedrock/issues/" target="_blank" rel="noopener" title="Report a problem with this documentation" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M256 0c53 0 96 43 96 96v3.6c0 15.7-12.7 28.4-28.4 28.4H188.5c-15.7 0-28.4-12.7-28.4-28.4V96c0-53 43-96 96-96zM41.4 105.4c12.5-12.5 32.8-12.5 45.3 0l64 64c.7.7 1.3 1.4 1.9 2.1 14.2-7.3 30.4-11.4 47.5-11.4h112c17.1 0 33.2 4.1 47.5 11.4.6-.7 1.2-1.4 1.9-2.1l64-64c12.5-12.5 32.8-12.5 45.3 0s12.5 32.8 0 45.3l-64 64c-.7.7-1.4 1.3-2.1 1.9 6.2 12 10.1 25.3 11.1 39.5h64.3c17.7 0 32 14.3 32 32s-14.3 32-32 32h-64c0 24.6-5.5 47.8-15.4 68.6q3.3 1.95 6 4.8l64 64c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0l-63.1-63.1c-24.5 21.8-55.8 36.2-90.3 39.6V240c0-8.8-7.2-16-16-16s-16 7.2-16 16v239.2c-34.5-3.4-65.8-17.8-90.3-39.6l-63.1 63c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l64-64c1.9-1.9 3.9-3.4 6-4.8C101.5 367.8 96 344.6 96 320H32c-17.7 0-32-14.3-32-32s14.3-32 32-32h64.3c1.1-14.1 5-27.5 11.1-39.5-.7-.6-1.4-1.2-2.1-1.9l-64-64c-12.5-12.5-12.5-32.8 0-45.3z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy", "content.code.select", "content.code.annotate", "navigation.instant", "navigation.instant.progress", "navigation.tracking", "navigation.top", "navigation.indexes", "navigation.footer", "toc.follow", "search.suggest", "search.highlight", "search.share"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.60a45f97.min.js"></script>
      
    
  </body>
</html>