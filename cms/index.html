
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://mozilla.github.io/bedrock/cms/">
      
      
        <link rel="prev" href="../legal-docs/">
      
      
        <link rel="next" href="../sitemap/">
      
      
      <link rel="icon" href="../images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>Content Management System - Bedrock Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.a40c8224.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cms" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Bedrock Documentation" class="md-header__button md-logo" aria-label="Bedrock Documentation" data-md-component="logo">
      
  <img src="../images/mozilla-logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Bedrock Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Content Management System
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/mozilla/bedrock" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    mozilla/bedrock
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Bedrock Documentation" class="md-nav__button md-logo" aria-label="Bedrock Documentation" data-md-component="logo">
      
  <img src="../images/mozilla-logo.svg" alt="logo">

    </a>
    Bedrock Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/mozilla/bedrock" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    mozilla/bedrock
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../l10n/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Localization
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../coding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developing on Bedrock
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../browser-support/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Browser Support
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contribute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to Contribute
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../pipeline/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Continuous Integration & Deployment
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../testing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Front-end testing
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../task-queue/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Task Queue
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../redirects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Managing redirects
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../newsletters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Newsletters
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../legal-docs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Legal Docs
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Content Management System
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Content Management System
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cms" class="md-nav__link">
    <span class="md-ellipsis">
      CMS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CMS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#high-level-summary" class="md-nav__link">
    <span class="md-ellipsis">
      High-level summary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accessing-the-cms-on-your-local-machine" class="md-nav__link">
    <span class="md-ellipsis">
      Accessing the CMS on your local machine
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Accessing the CMS on your local machine">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sso-authentication-setup" class="md-nav__link">
    <span class="md-ellipsis">
      SSO authentication setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#non-sso-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Non-SSO authentication
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fetching-the-latest-cms-data-for-local-work" class="md-nav__link">
    <span class="md-ellipsis">
      Fetching the latest CMS data for local work
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#editing-current-content-surfaces" class="md-nav__link">
    <span class="md-ellipsis">
      Editing current content surfaces
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-new-content-surfaces" class="md-nav__link">
    <span class="md-ellipsis">
      Adding new content surfaces
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Adding new content surfaces">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-a-new-page-model" class="md-nav__link">
    <span class="md-ellipsis">
      Creating a new page model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#django-model-migrations" class="md-nav__link">
    <span class="md-ellipsis">
      Django model migrations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rendering-data-in-templates" class="md-nav__link">
    <span class="md-ellipsis">
      Rendering data in templates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#previewing-pages-in-the-cms-admin" class="md-nav__link">
    <span class="md-ellipsis">
      Previewing pages in the CMS admin
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-advanced-page-models-fields-and-blocks" class="md-nav__link">
    <span class="md-ellipsis">
      Using advanced page models, fields, and blocks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#writing-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Writing tests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-your-new-model-to-the-db-export" class="md-nav__link">
    <span class="md-ellipsis">
      Add your new model to the DB export
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-cms_allowed_page_models-setting" class="md-nav__link">
    <span class="md-ellipsis">
      The CMS_ALLOWED_PAGE_MODELS setting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The CMS_ALLOWED_PAGE_MODELS setting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-do-we-have-this-behaviour" class="md-nav__link">
    <span class="md-ellipsis">
      Why do we have this behaviour?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#migrating-django-pages-to-the-cms" class="md-nav__link">
    <span class="md-ellipsis">
      Migrating Django pages to the CMS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Migrating Django pages to the CMS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-prefer_cms-decorator" class="md-nav__link">
    <span class="md-ellipsis">
      The @prefer_cms decorator
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generating-urls-for-cms-pages-in-non-cms-templates" class="md-nav__link">
    <span class="md-ellipsis">
      Generating URLs for CMS pages in non-CMS templates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#images" class="md-nav__link">
    <span class="md-ellipsis">
      Images
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Images">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-editor-uploaded-images-in-templates" class="md-nav__link">
    <span class="md-ellipsis">
      Using editor-uploaded images in templates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-are-we-limiting-filter-specs-to-that-set" class="md-nav__link">
    <span class="md-ellipsis">
      Why are we limiting filter-specs to that set?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ive-downloaded-a-fresh-db-and-the-images-are-missing" class="md-nav__link">
    <span class="md-ellipsis">
      I've downloaded a fresh DB and the images are missing!
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#l10n-and-translation-management" class="md-nav__link">
    <span class="md-ellipsis">
      L10N and Translation Management
    </span>
  </a>
  
    <nav class="md-nav" aria-label="L10N and Translation Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#page-tree-concept" class="md-nav__link">
    <span class="md-ellipsis">
      Page-tree concept
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#locale-configuration-within-wagtail" class="md-nav__link">
    <span class="md-ellipsis">
      Locale configuration within Wagtail
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#localization-process" class="md-nav__link">
    <span class="md-ellipsis">
      Localization process
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manual-updates" class="md-nav__link">
    <span class="md-ellipsis">
      Manual updates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automated-via-smartling" class="md-nav__link">
    <span class="md-ellipsis">
      Automated via Smartling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automated-via-pontoon" class="md-nav__link">
    <span class="md-ellipsis">
      Automated via Pontoon
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#infrastructure-notes" class="md-nav__link">
    <span class="md-ellipsis">
      Infrastructure notes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Infrastructure notes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sso-authentication-setup_1" class="md-nav__link">
    <span class="md-ellipsis">
      SSO authentication setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#non-sso-authentication-for-local-builds" class="md-nav__link">
    <span class="md-ellipsis">
      Non-SSO authentication for local builds
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../sitemap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sitemaps
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../banners/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Banners
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../uitour/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mozilla.UITour
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../send-to-device/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Send to Device widget
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../download-buttons/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Firefox Download Buttons
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../mozilla-accounts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mozilla account helpers
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../abtest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A/B Testing
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../vpn-subscriptions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mozilla VPN Subscriptions
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_22" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../attribution/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Attribution
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_22" id="__nav_22_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_22_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_22">
            <span class="md-nav__icon md-icon"></span>
            Attribution
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../attribution/0001-analytics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mozorg Analytics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../attribution/0002-firefox-desktop/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Firefox Desktop attribution
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../attribution/0003-firefox-mobile/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Firefox Mobile attribution
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../attribution/0004-mozilla-accounts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mozilla accounts attribution
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../attribution/0005-affiliate-marketing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mozilla CJMS Affiliate attribution
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../attribution/0006-consent-management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Managing Data Privacy and Concent
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_23" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../architecture/decisions/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Architectural Decision Records
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_23" id="__nav_23_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_23_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_23">
            <span class="md-nav__icon md-icon"></span>
            Architectural Decision Records
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0001-record-architecture-decisions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. Record architecture decisions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0002-move-ci-cd-pipelines-to-gitlab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Move CI/CD Pipelines to Gitlab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0003-use-cloudflare-workers-and-convert-for-multi-variant-testing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Use Cloudflare Workers and Convert for multi-variant testing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0004-use-fluent-for-localization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Use Fluent For Localization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0005-use-a-single-docker-image-for-all-deployments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. Use a Single Docker Image For All Deployments
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0006-revise-tooling-for-python-dependency-management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. Revise tooling for Python dependency management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0007-further-revise-tooling-for-python-dependency-management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7. Further revise tooling for Python dependency management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0008-move-demos-to-gcp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    8. Move Demos To GCP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0009-use-manage-contentful-migrations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    9. Manage Contentful schema state via migrations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0010-move-ci-cd-to-github-actions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    10. Move CI to Github Actions for Unit and Integration tests
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0011-use-statsd-for-metrics-collection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    11. Use StatsD for metrics collection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/decisions/0012-wagtail-for-cms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    12. Use Wagtail CMS
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contentful/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contentful (deprecated)
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../content-cards/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    External Content Cards (deprecated)
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cms" class="md-nav__link">
    <span class="md-ellipsis">
      CMS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CMS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#high-level-summary" class="md-nav__link">
    <span class="md-ellipsis">
      High-level summary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accessing-the-cms-on-your-local-machine" class="md-nav__link">
    <span class="md-ellipsis">
      Accessing the CMS on your local machine
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Accessing the CMS on your local machine">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sso-authentication-setup" class="md-nav__link">
    <span class="md-ellipsis">
      SSO authentication setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#non-sso-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Non-SSO authentication
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fetching-the-latest-cms-data-for-local-work" class="md-nav__link">
    <span class="md-ellipsis">
      Fetching the latest CMS data for local work
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#editing-current-content-surfaces" class="md-nav__link">
    <span class="md-ellipsis">
      Editing current content surfaces
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-new-content-surfaces" class="md-nav__link">
    <span class="md-ellipsis">
      Adding new content surfaces
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Adding new content surfaces">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-a-new-page-model" class="md-nav__link">
    <span class="md-ellipsis">
      Creating a new page model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#django-model-migrations" class="md-nav__link">
    <span class="md-ellipsis">
      Django model migrations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rendering-data-in-templates" class="md-nav__link">
    <span class="md-ellipsis">
      Rendering data in templates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#previewing-pages-in-the-cms-admin" class="md-nav__link">
    <span class="md-ellipsis">
      Previewing pages in the CMS admin
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-advanced-page-models-fields-and-blocks" class="md-nav__link">
    <span class="md-ellipsis">
      Using advanced page models, fields, and blocks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#writing-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Writing tests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-your-new-model-to-the-db-export" class="md-nav__link">
    <span class="md-ellipsis">
      Add your new model to the DB export
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-cms_allowed_page_models-setting" class="md-nav__link">
    <span class="md-ellipsis">
      The CMS_ALLOWED_PAGE_MODELS setting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The CMS_ALLOWED_PAGE_MODELS setting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-do-we-have-this-behaviour" class="md-nav__link">
    <span class="md-ellipsis">
      Why do we have this behaviour?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#migrating-django-pages-to-the-cms" class="md-nav__link">
    <span class="md-ellipsis">
      Migrating Django pages to the CMS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Migrating Django pages to the CMS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-prefer_cms-decorator" class="md-nav__link">
    <span class="md-ellipsis">
      The @prefer_cms decorator
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generating-urls-for-cms-pages-in-non-cms-templates" class="md-nav__link">
    <span class="md-ellipsis">
      Generating URLs for CMS pages in non-CMS templates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#images" class="md-nav__link">
    <span class="md-ellipsis">
      Images
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Images">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-editor-uploaded-images-in-templates" class="md-nav__link">
    <span class="md-ellipsis">
      Using editor-uploaded images in templates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-are-we-limiting-filter-specs-to-that-set" class="md-nav__link">
    <span class="md-ellipsis">
      Why are we limiting filter-specs to that set?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ive-downloaded-a-fresh-db-and-the-images-are-missing" class="md-nav__link">
    <span class="md-ellipsis">
      I've downloaded a fresh DB and the images are missing!
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#l10n-and-translation-management" class="md-nav__link">
    <span class="md-ellipsis">
      L10N and Translation Management
    </span>
  </a>
  
    <nav class="md-nav" aria-label="L10N and Translation Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#page-tree-concept" class="md-nav__link">
    <span class="md-ellipsis">
      Page-tree concept
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#locale-configuration-within-wagtail" class="md-nav__link">
    <span class="md-ellipsis">
      Locale configuration within Wagtail
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#localization-process" class="md-nav__link">
    <span class="md-ellipsis">
      Localization process
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manual-updates" class="md-nav__link">
    <span class="md-ellipsis">
      Manual updates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automated-via-smartling" class="md-nav__link">
    <span class="md-ellipsis">
      Automated via Smartling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automated-via-pontoon" class="md-nav__link">
    <span class="md-ellipsis">
      Automated via Pontoon
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#infrastructure-notes" class="md-nav__link">
    <span class="md-ellipsis">
      Infrastructure notes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Infrastructure notes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sso-authentication-setup_1" class="md-nav__link">
    <span class="md-ellipsis">
      SSO authentication setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#non-sso-authentication-for-local-builds" class="md-nav__link">
    <span class="md-ellipsis">
      Non-SSO authentication for local builds
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Content Management System</h1>

<h2 id="cms">CMS<a class="headerlink" href="#cms" title="Permanent link">&para;</a></h2>
<p>From 2024, Bedrock's CMS will be powered by <a href="https://wagtail.org/">Wagtail CMS</a>.</p>
<p>This page is currently a skeleton for documentation to be added as the work evolves.</p>
<h3 id="high-level-summary">High-level summary<a class="headerlink" href="#high-level-summary" title="Permanent link">&para;</a></h3>
<p>Wagtail CMS will be used to make either entire pages or portions of pages (let's call them 'surfaces') content-editable on <a href="http://www.mozilla.org">www.mozilla.org</a>. It is not a free-for-all add-any-page-you-like approach, but rather a careful rollout of surfaces with appropriate guard rails that helps ensure the integrity, quality and security of <a href="http://www.mozilla.org">www.mozilla.org</a>.</p>
<p>Surfaces will be authored via a closed 'Editing' deployment and when those changes are published they will become visible on the main <a href="http://www.mozilla.org">www.mozilla.org</a> 'Web' deployment.</p>
<p>If you are new to Wagtail, it is recommended that you read the official docs and/or complete an online course to get a better understanding of how Wagtail works.</p>
<p>Useful resources:</p>
<ul>
<li><a href="https://guide.wagtail.org/en-latest/">Wagtail Editor Guide</a>.</li>
<li><a href="https://docs.wagtail.org/">Wagtail Docs</a>.</li>
<li><a href="https://learnwagtail.com/courses/the-ultimate-wagtail-developers-course/">The Ultimate Wagtail Developers Course</a>.</li>
</ul>
<h3 id="accessing-the-cms-on-your-local-machine">Accessing the CMS on your local machine<a class="headerlink" href="#accessing-the-cms-on-your-local-machine" title="Permanent link">&para;</a></h3>
<h4 id="sso-authentication-setup">SSO authentication setup<a class="headerlink" href="#sso-authentication-setup" title="Permanent link">&para;</a></h4>
<ol>
<li>Become a member of <code>bedrock_cms_local_dev-access</code> on people.mozilla.org. Make sure you remember to accept the email invitation.</li>
<li>Extend your <code>.env</code> file with the development OIDC credentials that have been supplied to you. (make sure your <code>.env</code> file is based on a recent copy of <code>.env-dist</code> as several new variables exist).</li>
<li>In your <code>.env</code> file set the following variables:<ul>
<li><code>USE_SSO_AUTH=True</code></li>
<li><code>WAGTAIL_ENABLE_ADMIN=TRUE</code></li>
<li><code>WAGTAIL_ADMIN_EMAIL=YOUR_MOZILLA_LDAP_EMAIL@mozilla.com</code></li>
</ul>
</li>
<li>Run <code>make preflight</code> to update bedrock with the latest DB version. As part of this step, the make file will also create a local admin user for you, using the Mozilla LDAP email address you added in the previous step. <strong>If you do not want to overwrite your local database, run</strong> <code>make preflight -- --retain-db</code> <strong>instead.</strong></li>
<li>Start bedrock running via <code>npm start</code> (for local dev) or <code>make build run</code> (for Docker).</li>
<li>Go to <code>http://localhost:8000/cms-admin/</code> and you should see a button to login with SSO. Click it and you should go through the OAuth flow and end up in the Wagtail admin.</li>
</ol>
<h4 id="non-sso-authentication">Non-SSO authentication<a class="headerlink" href="#non-sso-authentication" title="Permanent link">&para;</a></h4>
<ol>
<li>In your <code>.env</code> file set <code>USE_SSO_AUTH=False</code>, and <code>WAGTAIL_ENABLE_ADMIN=TRUE</code>.</li>
<li>Run <code>make preflight</code> to update bedrock with the latest DB version. <strong>If you do not want to overwrite your local database, run</strong> <code>make preflight -- --retain-db</code> <strong>instead.</strong></li>
<li>Create a local admin user with <code>./manage.py createsuperuser</code>, setting both the username, email and password to whatever you choose (note: these details will only be stored locally on your device).</li>
<li>Alternatively, if you define <code>WAGTAIL_ADMIN_EMAIL=YOUR_MOZILLA_LDAP_EMAIL@mozilla.com</code> and <code>WAGTAIL_ADMIN_PASSWORD=somepassword</code> in your <code>.env.</code> file, <code>make preflight</code> will automatically create a non-SSO superuser for you</li>
<li>Start bedrock running via <code>npm start</code> (for local dev) or <code>make build run</code> (for Docker).</li>
<li>Go to <code>http://localhost:8000/cms-admin/</code> and you should see a form for logging in with a username and password. Use the details you created in the previous step.</li>
</ol>
<h3 id="fetching-the-latest-cms-data-for-local-work">Fetching the latest CMS data for local work<a class="headerlink" href="#fetching-the-latest-cms-data-for-local-work" title="Permanent link">&para;</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
</div>
<p><strong>TL;DR version:</strong></p>
<ol>
<li>Get the DB with <code>make preflight</code></li>
<li>If you need the images that the DB expects to exist, use <code>python manage.py download_media_to_local</code>
::::</li>
</ol>
<p>The CMS content exists in hosted cloud database and a trimmed-down version of this data is exported to a sqlite DB for use in local development and other processes. The exported database contains all the same content, but deliberately omits sensitive info like user accounts, unpublished drafts and outmoded versions of pages.</p>
<p>The DB export is generated twice a day and is put into the same public cloud buckets we've used for years. Your local Bedrock install will just download the <code>bedrock-dev</code> one as part of <code>make preflight</code>.</p>
<p>The DB will contain a table that knows the relative paths of the images uploaded to the CMS, but not the actual images. Those are in a cloud storage bucket, and if you want your local machine to have them available after you download the DB that expects them to be present, you can run <code>python manage.py download_media_to_local</code> which will sync down any images you don't already have.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
</div>
<p>By default, <code>make preflight</code> and <code>./bin/run-db-download.py</code> will download a database file based on <code>bedrock-dev</code>. If you want to download from stage or prod, which are also available in sanitised form, you need to tell Bedrock which environment you want by prefixing the command with <code>AWS_DB_S3_BUCKET=bedrock-db-stage</code> or <code>AWS_DB_S3_BUCKET=bedrock-db-prod</code>.</p>
<p><code>AWS_DB_S3_BUCKET=bedrock-db-stage make preflight</code></p>
<p><code>python manage.py download_media_to_local --environment=stage</code>
::::</p>
<h3 id="editing-current-content-surfaces">Editing current content surfaces<a class="headerlink" href="#editing-current-content-surfaces" title="Permanent link">&para;</a></h3>
<p>In terms of managing the content of an existing surface, please see the general <a href="https://guide.wagtail.org/en-latest/">Wagtail Editor Guide</a> for now.</p>
<p>If you want to change the code-defined behaviour of an existing surface, that's similar to adding a new content surface, covered below. You may also find the <a href="https://docs.wagtail.org/">Wagtail Docs</a> and <a href="https://learnwagtail.com/courses/the-ultimate-wagtail-developers-course/">The Ultimate Wagtail Developers Course</a> useful if you don't have experience of building with Wagtail yet.</p>
<h3 id="adding-new-content-surfaces">Adding new content surfaces<a class="headerlink" href="#adding-new-content-surfaces" title="Permanent link">&para;</a></h3>
<p>This is an introduction to creating new content surfaces in the CMS. It is not a comprehensive guide, but rather a starting point to get you up and running with the basics.</p>
<p>The page types that you see in the CMS admin are defined as regular models in Django. As such, you can define new page types in the same way you would define any other Django model, using Wagtail's field types and panels to define the data that can be entered into the page.</p>
<p>When it comes to structuring CMS page models, there are some general guidelines to try and follow:</p>
<ul>
<li>Models and templates should be defined in the same Django app that corresponds to where the URL exists in Bedrock's information architecture (IA) hierarchy, similar to what we do for regular Jinja templates already. For example, a Mozilla themed page should be defined in <code>/bedrock/mozorg/models.py</code>, and a Firefox themed page model should be in <code>/bedrock/firefox/models.py</code>.</li>
<li>Global <code>Page</code> models and <code>StreamField</code> blocks that are shared across many pages throughout the site should be defined in <code>/bedrock/cms/</code>.</li>
</ul>
<p>Structuring code in this way should hopefully help to keep things organized and migrations in a manageable state.</p>
<h4 id="creating-a-new-page-model">Creating a new page model<a class="headerlink" href="#creating-a-new-page-model" title="Permanent link">&para;</a></h4>
<p>Let's start by creating a new Wagtail page model called <code>TestPage</code> in <code>bedrock/mozorg/models.py</code>.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.db</span><span class="w"> </span><span class="kn">import</span> <span class="n">models</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">wagtail.admin.panels</span><span class="w"> </span><span class="kn">import</span> <span class="n">FieldPanel</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">wagtail.fields</span><span class="w"> </span><span class="kn">import</span> <span class="n">RichTextField</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="kn">from</span><span class="w"> </span><span class="nn">bedrock.cms.models.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">AbstractBedrockCMSPage</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="k">class</span><span class="w"> </span><span class="nc">TestPage</span><span class="p">(</span><span class="n">AbstractBedrockCMSPage</span><span class="p">):</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">heading</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="n">body</span> <span class="o">=</span> <span class="n">RichTextField</span><span class="p">(</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>        <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>        <span class="n">features</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">WAGTAIL_RICHTEXT_FEATURES_FULL</span><span class="p">,</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="p">)</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    <span class="n">content_panels</span> <span class="o">=</span> <span class="n">AbstractBedrockCMSPage</span><span class="o">.</span><span class="n">content_panels</span> <span class="o">+</span> <span class="p">[</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>        <span class="n">FieldPanel</span><span class="p">(</span><span class="s2">&quot;heading&quot;</span><span class="p">),</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>        <span class="n">FieldPanel</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">),</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    <span class="p">]</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>    <span class="n">template</span> <span class="o">=</span> <span class="s2">&quot;mozorg/test_page.html&quot;</span>
</span></code></pre></div>
<p>Some key things to note here:</p>
<ul>
<li><code>TestPage</code> is a subclass of <code>AbstractBedrockCMSPage</code>, which is a common base class for all Wagtail pages in bedrock. Inheriting from <code>AbstractBedrockCMSPage</code> allows CMS pages to use features that exist outside of Wagtail, such as rendering Fluent strings and other L10n methods.</li>
<li>The <code>TestPage</code> model defines two database field called <code>heading</code> and <code>body</code>. The <code>heading</code> field is a <code>CharField</code> (the most simple text entry field type), and <code>body</code> is a <code>RichTextField</code>. The HTML tags and elements that a content editor can enter into a rich text field are defined in <code>settings.WAGTAIL_RICHTEXT_FEATURES_FULL</code>.</li>
<li>There is also a <code>title</code> field on the page model, which from <code>AbstractBedrockCMSPage</code> (which in turn comes from <code>wagtail.models.Page</code>). This doesn't make <code>heading</code> redundant, but it's worth knowing where <code>title</code> comes from.</li>
<li>Both fields are added to the CMS admin panel by adding each as a <code>FieldPanel</code> to <code>content_panels</code>. If you forget to do this, that's usually why you don't see the field in the CMS admin.</li>
<li>Finally, the template used to render the page type can be found at <code>mozorg/test_page.html</code>.</li>
<li>If you don't set a custom template name, Wagtail will infer it from the model's name: <code>&lt;app_label&gt;/&lt;model_name (in snake case)&gt;.html</code></li>
<li>All new models must be added to the config for the DB exporter script. If you do not, the page will not be correctly exported for local development and will break for anyone using that DB export file. See <code>Add your new model to the DB export</code>, below.</li>
</ul>
<h4 id="django-model-migrations">Django model migrations<a class="headerlink" href="#django-model-migrations" title="Permanent link">&para;</a></h4>
<p>Once you have your model defined, it's then time to run create and run migrations to set up a database table for it:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>./manage.py<span class="w"> </span>makemigrations
</span></code></pre></div>
<p>You can then run migrations using:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>./manage.py<span class="w"> </span>migrate
</span></code></pre></div>
<p>Many times when you make changes to a model, it will also mean that the structure of the database table has changed. So as a general rule it's good to form a habit of running the above steps after making changes to your model. Each migration you make will add a new migration file to the <code>/migrations</code> directory. When doing local development for a new page you might find yourself doing this several times, so to help reduce the number of migration files you create you can also squash / merge them.</p>
<ul>
<li><a href="https://docs.djangoproject.com/en/4.2/topics/migrations/">Django migrations docs</a>.</li>
<li><a href="https://docs.djangoproject.com/en/4.2/topics/migrations/">Squashing migrations</a>.</li>
</ul>
<h4 id="rendering-data-in-templates">Rendering data in templates<a class="headerlink" href="#rendering-data-in-templates" title="Permanent link">&para;</a></h4>
<p>This is a good time to test out your page model by adding data to it to see how it renders in your template.</p>
<p>The data can be rendered in <code>mozorg/test_page.html</code> as follows:</p>
<div class="language-jinja highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="cp">{%</span> <span class="k">extends</span> <span class="s2">&quot;base-protocol-mozilla.html&quot;</span> <span class="cp">%}</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="cp">{%</span> <span class="k">block</span> <span class="nv">page_title</span> <span class="cp">%}{{</span> <span class="nv">page.title</span> <span class="cp">}}{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="cp">{%</span> <span class="k">block</span> <span class="nv">content</span> <span class="cp">%}</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="x">    &lt;header&gt;</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="x">    &lt;h1&gt;</span><span class="cp">{{</span> <span class="nv">page.heading</span> <span class="cp">}}</span><span class="x">&lt;/h1&gt;</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="x">    &lt;div class=&quot;w-rich-text&quot;&gt;</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="x">        </span><span class="cp">{{</span> <span class="nv">page.body</span><span class="o">|</span><span class="nf">richtext</span> <span class="cp">}}</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="x">    &lt;/div&gt;</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="x">    &lt;/header&gt;</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</span></code></pre></div>
<p>Note the <code>|richtext</code> filter applied to the <code>page.body</code> field. This is a Wagtail-provided Jinja2 filter that will render the rich text field as HTML.</p>
<h4 id="previewing-pages-in-the-cms-admin">Previewing pages in the CMS admin<a class="headerlink" href="#previewing-pages-in-the-cms-admin" title="Permanent link">&para;</a></h4>
<p>Next, restart your local server and log in to the CMS admin. Browse to a page and use the <code>+</code> icon or similar to add a new "child page". You should now see your new page type in the list of available pages. Create a new page using the <code>TestPage</code> type, give the page a title of <code>Test Page</code> and a slug of <code>test</code>, and then enter some data for the fields you defined. When you click the preview icon in the top right of the CMS page, you should hopefully see your template and data rendered successfully!</p>
<h4 id="using-advanced-page-models-fields-and-blocks">Using advanced page models, fields, and blocks<a class="headerlink" href="#using-advanced-page-models-fields-and-blocks" title="Permanent link">&para;</a></h4>
<p>The example above was relatively simple in terms of data, but not very flexible. Now that you have the basics covered, the next step is to start thinking about your page requirements, and how to better structure your data models.</p>
<p>At this point, deep diving into the <a href="https://docs.wagtail.org/">Wagtail Docs</a> is very much recommended. In particular, reading up on more advanced concepts such as <a href="https://docs.wagtail.org/en/stable/topics/streamfield.html">Stream Fields</a> and <a href="https://docs.wagtail.org/en/stable/advanced_topics/customisation/streamfield_blocks.html#custom-streamfield-blocks">Custom Block types</a> will make it possible to make much more advanced CMS page types.</p>
<p>This is also a good time to start thinking about guardrails for your page and data. Some common things to consider:</p>
<ul>
<li>Are there rules around the type of content that should be allowed on the page, such as the minimum or maximum number of items in a block?</li>
<li>Should there be a set order to content in a page, or can it be flexible?</li>
<li>Are there rules that should be applied at the page level, such as where it should live in the site hierarchy?</li>
<li>Should there be a limit to the number of instances of that page type? (e.g. it would be confusing to have more than one home page or contact page).</li>
</ul>
<h4 id="writing-tests">Writing tests<a class="headerlink" href="#writing-tests" title="Permanent link">&para;</a></h4>
<p>When it comes to testing CMS page models, <a href="https://github.com/wagtail/wagtail-factories">wagtail_factories</a> can be used to create mock data for tests to render. This can often be the trickiest part when testing more complex page models, so it takes some practice.</p>
<p>Factories for your page models and blocks should be defined in a <code>factories.py</code> file for your tests to import:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">factory</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">wagtail_factories</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">bedrock.mozorg</span><span class="w"> </span><span class="kn">import</span> <span class="n">TestPage</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="k">class</span><span class="w"> </span><span class="nc">TestPageFactory</span><span class="p">(</span><span class="n">wagtail_factories</span><span class="o">.</span><span class="n">PageFactory</span><span class="p">):</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>    <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Test Page&quot;</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>    <span class="n">live</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>    <span class="n">slug</span> <span class="o">=</span> <span class="s2">&quot;test&quot;</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>    <span class="n">heading</span> <span class="o">=</span> <span class="n">wagtail_factories</span><span class="o">.</span><span class="n">CharBlockFactory</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>    <span class="n">body</span> <span class="o">=</span> <span class="n">wagtail_factories</span><span class="o">.</span><span class="n">CharBlockFactory</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TestPage</span>
</span></code></pre></div>
<p>In your <code>test_models.py</code> file, you can then import the factory for your test and give it some data to render:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">wagtail.rich_text</span><span class="w"> </span><span class="kn">import</span> <span class="n">RichText</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">bedrock.cms.tests.conftest</span><span class="w"> </span><span class="kn">import</span> <span class="n">minimal_site</span>  <span class="c1"># noqa</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">bedrock.mozorg.tests</span><span class="w"> </span><span class="kn">import</span> <span class="n">factories</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="n">pytestmark</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>    <span class="n">pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">django_db</span><span class="p">,</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="p">]</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span><span class="s2">&quot;serving_method&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;serve&quot;</span><span class="p">,</span> <span class="s2">&quot;serve_preview&quot;</span><span class="p">))</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="k">def</span><span class="w"> </span><span class="nf">test_page</span><span class="p">(</span><span class="n">minimal_site</span><span class="p">,</span> <span class="n">rf</span><span class="p">,</span> <span class="n">serving_method</span><span class="p">):</span>  <span class="c1"># noqa</span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>    <span class="n">root_page</span> <span class="o">=</span> <span class="n">minimal_site</span><span class="o">.</span><span class="n">root_page</span>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>    <span class="n">test_page</span> <span class="o">=</span> <span class="n">factories</span><span class="o">.</span><span class="n">TestPageFactory</span><span class="p">(</span>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>        <span class="n">parent</span><span class="o">=</span><span class="n">root_page</span><span class="p">,</span>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a>        <span class="n">heading</span><span class="o">=</span><span class="s2">&quot;Test Heading&quot;</span><span class="p">,</span>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a>        <span class="n">body</span><span class="o">=</span><span class="n">RichText</span><span class="p">(</span><span class="s2">&quot;Test Body&quot;</span><span class="p">),</span>
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a>    <span class="p">)</span>
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a>
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a>    <span class="n">test_page</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span><span id="__span-5-23"><a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a>
</span><span id="__span-5-24"><a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a>    <span class="n">_relative_url</span> <span class="o">=</span> <span class="n">test_page</span><span class="o">.</span><span class="n">relative_url</span><span class="p">(</span><span class="n">minimal_site</span><span class="p">)</span>
</span><span id="__span-5-25"><a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a>    <span class="k">assert</span> <span class="n">_relative_url</span> <span class="o">==</span> <span class="s2">&quot;/en-US/test/&quot;</span>
</span><span id="__span-5-26"><a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a>    <span class="n">request</span> <span class="o">=</span> <span class="n">rf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_relative_url</span><span class="p">)</span>
</span><span id="__span-5-27"><a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a>
</span><span id="__span-5-28"><a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a>    <span class="n">resp</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">test_page</span><span class="p">,</span> <span class="n">serving_method</span><span class="p">)(</span><span class="n">request</span><span class="p">)</span>
</span><span id="__span-5-29"><a id="__codelineno-5-29" name="__codelineno-5-29" href="#__codelineno-5-29"></a>    <span class="n">page_content</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</span><span id="__span-5-30"><a id="__codelineno-5-30" name="__codelineno-5-30" href="#__codelineno-5-30"></a>    <span class="k">assert</span> <span class="s2">&quot;Test Heading&quot;</span> <span class="ow">in</span> <span class="n">page_content</span>
</span><span id="__span-5-31"><a id="__codelineno-5-31" name="__codelineno-5-31" href="#__codelineno-5-31"></a>    <span class="k">assert</span> <span class="s2">&quot;Test Body&quot;</span> <span class="ow">in</span> <span class="n">page_content</span>
</span></code></pre></div>
<h4 id="add-your-new-model-to-the-db-export">Add your new model to the DB export<a class="headerlink" href="#add-your-new-model-to-the-db-export" title="Permanent link">&para;</a></h4>
<p>When you add a new model, you must update the script that generates the sqlite DB export of our data, so that the model is included in the export. (It's an allowlist pattern, as requested by Mozilla Security).</p>
<p><strong>If you do not, the page will not be correctly exported for local development and will break for anyone using that DB export file.</strong></p>
<p>(It's down to Wagtail's multi-table inheritance pattern: if you don't specify your new model for export, Wagtail's core metadata <code>Page</code> is exported, but not the actual new data model that holds the content that's linked to that <code>Page</code>)</p>
<p>The script is <code>bin/export-db-to-sqlite.sh</code> and you need to add your new model to the list of models being exported. Search for <code>MAIN LIST OF MODELS BEING EXPORTED</code> and add your model (in the format <code>appname.ModelName</code>) there.</p>
<h4 id="the-cms_allowed_page_models-setting">The <code>CMS_ALLOWED_PAGE_MODELS</code> setting<a class="headerlink" href="#the-cms_allowed_page_models-setting" title="Permanent link">&para;</a></h4>
<p>When you add a new page to the CMS, it will be available to add as a new child page immediately if <code>DEV=True</code>. This means it'll be on Dev (www-dev), but not in Staging or Prod.</p>
<p>So if you ship a page that needs to be used immediately in Production (which will generally be most cases), you must remember to add it to <code>CMS_ALLOWED_PAGE_MODELS</code> in Bedrock's settings. If you do not, it will not be selectable as a new Child Page in the CMS.</p>
<h5 id="why-do-we-have-this-behaviour">Why do we have this behaviour?<a class="headerlink" href="#why-do-we-have-this-behaviour" title="Permanent link">&para;</a></h5>
<p>Two reasons:</p>
<ol>
<li>This setting allows us to complete initial/eager work to add a new page type, but stop it being used in Production until we are ready for it (e.g. a special new campaign page type that we wanted to get ready in good time). While there will be guard rails and approval workflows around publishing, without this it could still be possible for part of the org to start using a new page without us realising it was off-limits, and possibly before it is allowed to be released.</li>
<li>This approach allows us to gracefully deprecate pages: if a page is removed in <code>settings.CMS_ALLOWED_PAGE_MODELS</code>, that doesn't mean it disappears from Prod or can't be edited - it just stops a NEW one being added in Prod.</li>
</ol>
<h4 id="migrating-django-pages-to-the-cms">Migrating Django pages to the CMS<a class="headerlink" href="#migrating-django-pages-to-the-cms" title="Permanent link">&para;</a></h4>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is initial documentation, noting relevant things that exist already, but much fuller recommendations will follow</p>
</div>
<p>Migrating a surface to Wagtail is very similar to adding a new one, but some extra thought needs to be given to the switchover between old hardcoded content and new CMS-backed content.</p>
<h5 id="the-prefer_cms-decorator">The <code>@prefer_cms</code> decorator<a class="headerlink" href="#the-prefer_cms-decorator" title="Permanent link">&para;</a></h5>
<p>If you have an existing Django-based page that you want to move to be a CMS-driven page, you are faced with a quandry.</p>
<p>Let's say the page exists at <code>/some/path/</code>; you can create it in the CMS with a branch of pages that mirror the same slugs (a parent page with a slug of <code>some</code> and a child page with a slug of <code>path</code>). However, in order for anyone to see the published page, you would have to remove the reference to the Django view from the URLconf, so that Wagtail would get a chance to render it (because Wagtail's page-serving logic comes last in all URLConfs). <strong>BUT...</strong> how can you enter content into the CMS fast enough replace the just-removed Django page? (Note: we could use a data migraiton here, but that gets complicated when there are images involved)</p>
<p>Equally, you may have a situation where the content for certain paths needs to be managed in the CMS for certain locales, while other locales (with rarely changing 'evergreen' content) may only exist as Django-rendered views drawing strings from Fluent.</p>
<p>The answer here is to use the <code>bedrock.cms.decorators.prefer_cms</code> decorator/helper.</p>
<p>A Django view decorated with <code>prefer_cms</code> will check if a live CMS page has been added that matches the same overall, relative path as the Django view. If it finds one, it will show the user <code>that</code> CMS page instead. If there is no match in the CMS, then the original Django view will be used.</p>
<p>The result is a graceful handover flow that allows us to switch to the CMS page without needing to remove the Django view from the URLconf, or to maintain a hybrid approach to page management. It doesn't affect previews, so the review of draft pages before publishing can continue with no changes. Once the CMS is populated with a live version of the replacement page, that's when a later changeset can remove the deprecated Django view if it's no longer needed.</p>
<p>The <code>prefer_cms</code> decorator can be used directly on function-based views, or can wrap views in the URLconf. It should not used with <code>bedrock.mozorg.util.page</code> due to the complexity of passing through what locales are involved, but instead the relevant URL route should be refactored as a regular Django view, and then decorated with <code>prefer_cms</code></p>
<p>For more details, please see the docstring on <code>bedrock.cms.decorators.prefer_cms</code>.</p>
<h3 id="generating-urls-for-cms-pages-in-non-cms-templates">Generating URLs for CMS pages in non-CMS templates<a class="headerlink" href="#generating-urls-for-cms-pages-in-non-cms-templates" title="Permanent link">&para;</a></h3>
<p>Pages in the CMS don't appear in the hard-coded URLConfs in Bedrock. Normally, this means there's no way to use <code>url()</code> to generate a path to it.</p>
<p>However, if there's a page in the CMS you need to generate a URL for using the <code>url()</code> template tag, <code>and you know what its path will be</code>, Bedrock contains a solution.</p>
<p><code>bedrock.cms.cms_only_urls</code> is a special URLConf that only gets loaded during the call to the <code>url()</code> helper. If you expand it with a named route definition that matches the path you know will/should exist in the CMS (and most of our CMS-backed pages <code>do</code> have carefully curated paths), the <code>url()</code> helper will give you a path that points to that page, even though it doesn't really exist as a static Django view.</p>
<p>See the example in the <code>bedrock.cms.cms_only_urls.py</code> file.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Moving a URL route to <code>cms_only_urls.py</code> is a natural next step after you've migrated a page to the CMS using the <code>@prefer_cms</code> decorator and now want to remove the old view without breaking all the calls to <code>url('some.view')</code> or <code>reverse('some.view')</code>.</p>
</div>
<h3 id="images">Images<a class="headerlink" href="#images" title="Permanent link">&para;</a></h3>
<h4 id="using-editor-uploaded-images-in-templates">Using editor-uploaded images in templates<a class="headerlink" href="#using-editor-uploaded-images-in-templates" title="Permanent link">&para;</a></h4>
<p>Images may be uploaded into Wagtail's Image library and then included in content-managed surfaces that have fields/spaces for images.</p>
<p>Images are stored in the same media bucket that fixed/hard-coded Bedrock images get put in, and coexist alongside them, being namespaced into a directory called <code>custom-media/</code>.</p>
<p>If a surface uses an image, images use must be made explicit via template markup --- we need to state both <em>where</em> and <em>how</em> an image will be used in the template, including specifying the size the image will be. This is because --- by design and by default --- Wagtail can generate any size version that the template mentions by providing a "filter spec" e.g.</p>
<div class="language-jinja highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="cp">{%</span> <span class="k">set</span> <span class="nv">the_image</span><span class="o">=</span><span class="nv">image</span><span class="o">(</span><span class="nv">page.product_image</span><span class="o">,</span> <span class="s2">&quot;width-1200&quot;</span><span class="o">)</span> <span class="cp">%}</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="x">&lt;img class=&quot;some-class&quot; src=&quot;</span><span class="cp">{{</span> <span class="nv">the_image.url</span> <span class="cp">}}</span><span class="x">)&quot;/&gt;</span>
</span></code></pre></div>
<p>(More examples are available in the <a href="https://docs.wagtail.org/en/stable/topics/images.html">Wagtail Images docs</a>.)</p>
<p>When including an image in a template we ONLY use filter specs between 2400px down to 200px in 200px steps, plus 100px.</p>
<p>Laying them out, these are the <strong>only</strong> filter specs allowed. <strong>Using alternative ones will trigger an error in production.</strong></p>
<ul>
<li><code>width-100</code></li>
<li><code>width-200</code></li>
<li><code>width-400</code></li>
<li><code>width-600</code></li>
<li><code>width-800</code></li>
<li><code>width-1000</code></li>
<li><code>width-1200</code></li>
<li><code>width-1400</code></li>
<li><code>width-1600</code></li>
<li><code>width-1800</code></li>
<li><code>width-2000</code></li>
<li><code>width-2200</code></li>
<li><code>width-2400</code></li>
</ul>
<h4 id="why-are-we-limiting-filter-specs-to-that-set">Why are we limiting filter-specs to that set?<a class="headerlink" href="#why-are-we-limiting-filter-specs-to-that-set" title="Permanent link">&para;</a></h4>
<p>In a line: to balance infrastructure security constraints with site flexiblity, we have to pre-generate a known set of renditions.</p>
<p>Normally, if that <code>product_image</code> is not already available in <code>1024x1024</code>, Wagtail will resize the original image to suit, on the fly, and store this "rendition" (a resized version, basically) in the cloud bucket. It will also add a reference to the database so that Wagtail knows that the rendition already exists.</p>
<p>In production, the "Web" deployment has <strong>read-only</strong> access to the DB and to the cloud storage, so it will not be able to generate new renditions on the fly. Instead, we pre-generate those renditions when the image is saved.</p>
<p>This approach will not be a problem if we stick to image filter-specs from the 'approved' list. Note that extending the list of filter-specs is possible, if we need to.</p>
<h4 id="ive-downloaded-a-fresh-db-and-the-images-are-missing">I've downloaded a fresh DB and the images are missing!<a class="headerlink" href="#ive-downloaded-a-fresh-db-and-the-images-are-missing" title="Permanent link">&para;</a></h4>
<p>That's expected: the images don't live in the DB, only references to them live there. CMS images are destined for public consumption, and Dev, Stage and Prod all store their images in a publicly-accessible cloud bucket.</p>
<p>We have a tool to help you sync down the images from the relevant bucket.</p>
<p>By default, the sqlite DB you can download to run bedrock locally is based on the data in Bedrock Dev. To get images from the cloud bucket for dev, run:</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>./manage.py<span class="w"> </span>download_media_to_local
</span></code></pre></div>
<p>This will look at your local DB, find the image files that it says should be available locally, copy them down to your local machine, then trigger the versions/renditions of them that should also exist.</p>
<p>The command will only download images you don't already have locally. You can use the <code>--redownload</code> option to force a redownload of all images.</p>
<p>If you have a DB from Stage you can pass the <code>--environment=stage</code> option to get the images from the Stage bucket instead. Same goes for Production.</p>
<h3 id="l10n-and-translation-management">L10N and Translation Management<a class="headerlink" href="#l10n-and-translation-management" title="Permanent link">&para;</a></h3>
<p>:::: important</p>
<div class="admonition title">
<p class="admonition-title">Important</p>
</div>
<p>Localization via Wagtail is something we are ramping up on, so please do not assume the following notes are final, or that the workflows are currently all rock-solid. We're learning as we go.
::::</p>
<h4 id="page-tree-concept">Page-tree concept<a class="headerlink" href="#page-tree-concept" title="Permanent link">&para;</a></h4>
<p>Our Wagtail setup uses the official <a href="https://wagtail-localize.org/">wagtail-localize</a> package to manage localization of pages.</p>
<p>This package supports page-level localization rather than field-level localization, which means that each locale has its own distinct tree of pages, rather than each page having a stack of duplicate fields, one per destination language.</p>
<p>These language-specific trees can be "synchronised" with the default <code>en-US</code> page tree, so would have the same page structure, field by field) --- or they can not be synchronised, so can have their own extra pages, or some specific pages in the tree can be made not "synchronised", while others are.</p>
<p>Basically, there is plenty of flexibility. The flipside of that flexibility is we may also create an edge-case situation that <code>wagtail-localize</code> won't work with, but we'll have to see and deal with it.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It's worth investing 15 mins in watching the <a href="https://www.youtube.com/watch?v=mEzQcOMUzoc">Wagtail Localize original demo</a> to get a good feel of how it can work.</p>
</div>
<h4 id="locale-configuration-within-wagtail">Locale configuration within Wagtail<a class="headerlink" href="#locale-configuration-within-wagtail" title="Permanent link">&para;</a></h4>
<p>While the list of available overall locales is defined in code in <code>settings.base.WAGTAIL_CONTENT_LANGUAGES</code>, any locale also needs enabling via the Wagtail Admin UI before it can be used.</p>
<p>When you go to <code>Settings &gt; Locales</code> in the Wagtail fly-out menu, you will see which locales are currenly enabled. You can add new ones via the <code>+</code> icon.</p>
<p>:::: warning</p>
<div class="admonition title">
<p class="admonition-title">Warning</p>
</div>
<p>When you add/edit a Locale in this part of the admin, you will see an option to enable syncronisation between locales. <strong>Do not enable this</strong>. If it is enabled, for every new page added in <code>en-US</code>, it will auto-create page aliases in every other enabled locale and these will deliver the <code>en-US</code> content under locale-specific paths, which is not what we want.
::::</p>
<h4 id="localization-process">Localization process<a class="headerlink" href="#localization-process" title="Permanent link">&para;</a></h4>
<h4 id="manual-updates">Manual updates<a class="headerlink" href="#manual-updates" title="Permanent link">&para;</a></h4>
<p>At its most basic, there's nothing stopping us using copy-and-paste to enter translations into lang-specific pages, which might work well if we have a page in just one non-en-US lang and an in-house colleague doing the translation.</p>
<h4 id="automated-via-smartling">Automated via Smartling<a class="headerlink" href="#automated-via-smartling" title="Permanent link">&para;</a></h4>
<p>However, we also have automation available to send source strings to translation vendor Smartling. This uses the <code>wagtail-localize-smartling</code> package.</p>
<p>Here's the overall workflow:</p>
<ol>
<li>
<p>CMS page "MyPage" is created in the default lang (<code>en-US</code>)</p>
</li>
<li>
<p>The "Translate this page" option is triggered for MyPage, and relevant langs are selected from the configured langs that Smartling supports. (We don't have to translate into all of them)</p>
</li>
<li>
<p>A translation Job is created in Smartling, awaiting authorization by our L10N team.</p>
</li>
<li>
<p>A L10N team colleague authorizes the Job and selects the relevant translation workflow(s) for the relevant lang(s)</p>
<blockquote>
<ul>
<li> Note that one Wagtail Page (or one Wagtail Snippet) creates one single Job, so if you select mutiple target languages for that Job and submit it, you won't get it back from Smartling until <code>all</code> languages involved are submitted by translators. One way around this is to submit each language as a separate Job, but that creates more work for our L10N team to coordinate. (We are looking to refine that experience in the future and to make it better for everyone.)</li>
</ul>
</blockquote>
</li>
<li>
<p>Once the job is completed, the localised strings flow back to Wagtail and populate a <code>draft</code> version of each language-specific page.</p>
</li>
<li>
<p>A human reviews these draft pages and publishes them</p>
<blockquote>
<ul>
<li> When a translation flows back, by default the relevant pages are <code>not</code> automatically published. At the moment, CMS admins are emailed for each language in a Job when it is synced back from Smartling, reminding them of this. (We may well move this to in-dashboard Wagtail <code>Tasks</code> for better UX.)</li>
<li>The CMS admin sidebar has a link to <code>Smartling Jobs</code>. You can use this to see what translations have landed, and also follow the link to the localized version of the page, which you can then Preview, visually check, then Publish like a regular page.</li>
</ul>
</blockquote>
</li>
</ol>
<p><strong>Notes:</strong></p>
<ul>
<li>Smartling/<code>wagtail-localize-smartling</code> will only translate pages from the base lang (<code>en-US</code>) to another lang - it won't treat, say, a Page in <code>fr</code> as a source-language document.</li>
<li>If a string is received from Smartling into the CMS and then manually edited on the CMS side, the change will <code>not</code> be overwritten by subsequent Smartling syncs and the manual edit needs to be added on the Smartling side for consistency and stability.</li>
<li>If a page is translated from <code>en-US</code> once, then has new <code>en-US</code> content added that is sent for translation, that will trigger a new Smartling Job. When that job is complete, it <code>will</code> overwrite any manual edits made to a translation within the CMS. This is why it's important to make sure Smartling contains any manual tweaks done to translations in the CMS.</li>
</ul>
<h4 id="automated-via-pontoon">Automated via Pontoon<a class="headerlink" href="#automated-via-pontoon" title="Permanent link">&para;</a></h4>
<p>It should also be possible to use <a href="https://pontoon.mozilla.org/">Pontoon</a> with <code>wagtail-localize</code>. (There are notes on the <a href="https://wagtail-localize.org/stable/how-to/integrations/pontoon/">Pontoon integration</a> here, but we have not yet tried to enable this alongside <code>wagtail-localize-smartling</code>).</p>
<p>Additionally using Pontoon would let us benefit from community translations across a broad range of languages. However, we have yet to try to set this up and would need to agree which parts of the site do and do not use Pontoon.</p>
<h3 id="infrastructure-notes">Infrastructure notes<a class="headerlink" href="#infrastructure-notes" title="Permanent link">&para;</a></h3>
<h4 id="sso-authentication-setup_1">SSO authentication setup<a class="headerlink" href="#sso-authentication-setup_1" title="Permanent link">&para;</a></h4>
<p>When the env vars <code>OIDC_RP_CLIENT_ID</code> and <code>OIDC_RP_CLIENT_SECRET</code> are present and <code>USE_SSO_AUTH</code> is set to True in settings, Bedrock will use Mozilla SSO instead of Django's default username + password approach to sign in. The deployed sites will have these set, but we also have credentials available for using SSO locally if you need to develop something that needs it - see our password vault.</p>
<p>Note that Bedrock in SSO mode will <code>not</code> support 'drive by' user creation even if they have an <code>@mozilla.com</code> identity. Only users who already exist in the Wagtail admin as a User will be allowed to log in. You can create new users using Django's <a href="https://docs.djangoproject.com/en/5.0/ref/django-admin/#createsuperuser">createsuperuser</a> command, setting both the username and email to be your <code>flast@mozilla.com</code> LDAP address</p>
<h4 id="non-sso-authentication-for-local-builds">Non-SSO authentication for local builds<a class="headerlink" href="#non-sso-authentication-for-local-builds" title="Permanent link">&para;</a></h4>
<p>If you just want to use a username and password locally, you can - ensure those env vars above are not set, and use Django's <a href="https://docs.djangoproject.com/en/5.0/ref/django-admin/#createsuperuser">createsuperuser</a> command to make an admin user in your local build.</p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../legal-docs/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Legal Docs">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Legal Docs
              </div>
            </div>
          </a>
        
        
          
          <a href="../sitemap/" class="md-footer__link md-footer__link--next" aria-label="Next: Sitemaps">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Sitemaps
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
       Copyright 2011-2025, Mozilla
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/mozilla/bedrock/issues/" target="_blank" rel="noopener" title="Report a problem with this documentation" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M256 0c53 0 96 43 96 96v3.6c0 15.7-12.7 28.4-28.4 28.4H188.5c-15.7 0-28.4-12.7-28.4-28.4V96c0-53 43-96 96-96zM41.4 105.4c12.5-12.5 32.8-12.5 45.3 0l64 64c.7.7 1.3 1.4 1.9 2.1 14.2-7.3 30.4-11.4 47.5-11.4h112c17.1 0 33.2 4.1 47.5 11.4.6-.7 1.2-1.4 1.9-2.1l64-64c12.5-12.5 32.8-12.5 45.3 0s12.5 32.8 0 45.3l-64 64c-.7.7-1.4 1.3-2.1 1.9 6.2 12 10.1 25.3 11.1 39.5h64.3c17.7 0 32 14.3 32 32s-14.3 32-32 32h-64c0 24.6-5.5 47.8-15.4 68.6q3.3 1.95 6 4.8l64 64c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0l-63.1-63.1c-24.5 21.8-55.8 36.2-90.3 39.6V240c0-8.8-7.2-16-16-16s-16 7.2-16 16v239.2c-34.5-3.4-65.8-17.8-90.3-39.6l-63.1 63c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l64-64c1.9-1.9 3.9-3.4 6-4.8C101.5 367.8 96 344.6 96 320H32c-17.7 0-32-14.3-32-32s14.3-32 32-32h64.3c1.1-14.1 5-27.5 11.1-39.5-.7-.6-1.4-1.2-2.1-1.9l-64-64c-12.5-12.5-12.5-32.8 0-45.3z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy", "content.code.select", "content.code.annotate", "navigation.instant", "navigation.instant.progress", "navigation.tracking", "navigation.top", "navigation.indexes", "navigation.footer", "toc.follow", "search.suggest", "search.highlight", "search.share"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.60a45f97.min.js"></script>
      
    
  </body>
</html>