# This Source Code Form is subject to the terms of the Mozilla Public
# License, v. 2.0. If a copy of the MPL was not distributed with this
# file, You can obtain one at http://mozilla.org/MPL/2.0/.

# bug 1144901
<IfModule headers_module>
  header set X-Clacks-Overhead "GNU Terry Pratchett"
</IfModule>

# Static Media
RewriteRule ^/media/(.*)$ /b/media/$1 [L,PT]

ExpiresActive on

## Fix locales

# bug 774675
RewriteRule ^/en/(.*)$ /en-US/$1 [L,R=301]
RewriteRule ^/es/(.*)$ /es-ES/$1 [L,R=301]
RewriteRule ^/pt/(.*)$ /pt-BR/$1 [L,R=301]

# bug 880182
RewriteRule ^/ja-JP-mac(/.*)? /ja$1 [L,R=301]

# bug 795970 - lowercase to uppercase, e.g. en-us to en-US
RewriteMap toupper int:toupper
RewriteRule ^/([a-z]{2})-([a-z]{2})/(.*) /$1-${toupper:$2}/$3 [L,R=301]

## Redirect things externally!

# bug 855734 - if request comes in with hostname that has a trailing ".", strip it off
# (note that Apache will put the hostname with "." stripped as the host of the
# redirect URL by default; we just need to "redirect" to the same URL)
RewriteCond %{HTTP_HOST} ^(.*)\.$
RewriteRule ^(.*)$ $1 [L,R=301]

# bug 845988 - remove double slashes in URLs
RewriteRule ^(.*)//(.*)$ $1/$2 [L,R=301]

# bug 764261, 841393, 996608, 1008162, 1067691, 1113136, 1119022, 1131680
RewriteRule ^/zh-TW/$ http://mozilla.com.tw/ [L,R=301]
RewriteCond %{REQUEST_URI} !^/zh-TW/firefox/dnt
RewriteCond %{REQUEST_URI} !^/zh-TW/firefox/geolocation
RewriteCond %{REQUEST_URI} !^/zh-TW/firefox/independent
RewriteCond %{REQUEST_URI} !^/zh-TW/firefox/os/devices
RewriteCond %{REQUEST_URI} !^/zh-TW/firefox/tiles
RewriteCond %{REQUEST_URI} !^/zh-TW/firefox/android
RewriteCond %{REQUEST_URI} !^/zh-TW/firefox/sync
RewriteCond %{REQUEST_URI} !^/zh-TW/firefox/partners
RewriteCond %{REQUEST_URI} !^/zh-TW/firefox/desktop/tips
RewriteCond %{REQUEST_URI} !^/zh-TW/firefox/nightly/firstrun/?
RewriteCond %{REQUEST_URI} !^/zh-TW/firefox/hello
RewriteCond %{REQUEST_URI} !^/zh-TW/firefox(/(?:\d+\.\d+\.?(?:\d+)?\.?(?:\d+)?(?:[a|b]?)(?:\d*)(?:pre)?(?:\d)?))?/hello/start/?
RewriteCond %{REQUEST_URI} !^/zh-TW/firefox(/(?:\d+\.\d+\.?(?:\d+)?\.?(?:\d+)?(?:[a|b]?)(?:\d*)(?:pre)?(?:\d)?))?/firstrun/?
RewriteCond %{REQUEST_URI} !^/zh-TW/firefox(/(?:\d+\.\d+\.?(?:\d+)?\.?(?:\d+)?(?:[a|b]?)(?:\d*)(?:pre)?(?:\d)?))?/tour/?
RewriteCond %{REQUEST_URI} !^/zh-TW/firefox(/(?:\d+\.\d+\.?(?:\d+)?\.?(?:\d+)?(?:[a|b]?)(?:\d*)(?:pre)?(?:\d)?))?/whatsnew/?
RewriteRule ^/zh-TW/firefox(/.*)?$ http://mozilla.com.tw/firefox$1 [L,R=301]
RewriteRule ^/zh-TW/mobile/?$ http://mozilla.com.tw/firefox/mobile/ [L,R=301]
RewriteRule ^/zh-TW/download/?$ http://mozilla.com.tw/firefox/download/ [L,R=301]
RewriteRule ^/zh-TW/products(/.*)?$ http://mozilla.com.tw/products$1 [L,R=301]

# bug 874913
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?products/download.html$ /$1firefox/new/?#download-fx [NE,L,R=301]

# bug 845580
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?home/?$ /$1firefox/ [L,R=301]

# bug 948605
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/xp(.*)$ /firefox/ [L,R=301]

# bug 755826
RewriteRule ^/zh-CN/$ http://firefox.com.cn/ [L,R=301]

#bug 857246 redirect /products/firefox/start/  to start.mozilla.org
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?products/firefox/start(/?)$ http://start.mozilla.org [L,R=301]

# bug 875052
RewriteCond %{HTTP_USER_AGENT} seamonkey [NC]
RewriteRule ^/start/(.*)$ http://www.seamonkey-project.org/start/ [E=varyua:1,L,R=301]
RewriteRule ^/start/(.*)$ /firefox/ [L,R=301]

# bug 856081 redirect /about/drivers https://wiki.mozilla.org/Firefox/Drivers
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?about/drivers(\.html|/)?$ https://wiki.mozilla.org/Firefox/Drivers [L,R=301]

# bug 885797
RewriteRule ^/community/(?:directory|wikis|blogs|websites)\.html$ https://wiki.mozilla.org/Websites/Directory [L,R=301]

# bug 885856
RewriteRule ^/projects/index\.(de|fr|hr|sq)\.html$ /$1/products/ [L,R=301]

# bug 856075
RewriteRule ^/projects/technologies\.html$ https://developer.mozilla.org/docs/Mozilla/Using_Mozilla_code_in_other_projects [L,R=301]

# bug 787269
RewriteRule ^/projects/security/components/signed-script(?:s|-example)\.html$ https://developer.mozilla.org/docs/Bypassing_Security_Restrictions_and_Signing_Code [L,R=301]

# bug 874526, 877698
RewriteRule ^/projects/security/components(.*)$ http://www-archive.mozilla.org/projects/security/components$1 [L,R=301]

# bug 876889
RewriteRule ^/projects/testopia/?$ https://developer.mozilla.org/docs/Mozilla/Bugzilla/Testopia [L,R=301]

# bug 874525
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?projects/security/pki/nss.*$ https://developer.mozilla.org/docs/NSS [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?projects/security/pki/jss.*$ https://developer.mozilla.org/docs/JSS [L,R=301]

# bug 866190
RewriteRule ^/projects/security/pki/python-nss/?$ https://developer.mozilla.org/docs/Python_binding_for_NSS [L,R=301]

# bug 1043035
RewriteRule ^/projects/security/pki/(?:index.html)?$ https://developer.mozilla.org/docs/PKI [L,R=301]
RewriteRule ^/projects/security/pki/pkcs11.* https://developer.mozilla.org/docs/Mozilla/Projects/NSS#PKCS_.2311_information [NE,L,R=301]
RewriteRule ^/projects/security/pki/psm.* https://developer.mozilla.org/docs/Mozilla/Projects/PSM [L,R=301]
RewriteRule ^/projects/security/pki/src.* https://developer.mozilla.org/docs/Mozilla/Projects/NSS/NSS_Sources_Building_Testing [L,R=301]

# bug 975476
RewriteRule ^/projects/security/pki/python-nss/doc/api/current/html(.*)$ https://mozilla.github.io/python-nss-docs$1 [L,R=301]

# bug 780672
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/webhero(.*)$ /firefox/ [L,R=301]

# bug 964107
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/video https://www.youtube.com/firefoxchannel [L,R=301]

# bug 948520
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/livebookmarks(.*)$ "https://support.mozilla.org/kb/Live Bookmarks" [L,R=301]

# bug 782333
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/backtoschool(/?)$ https://addons.mozilla.org/firefox/collections/mozilla/back-to-school/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/backtoschool/firstrun(/?)$ /firefox/firstrun/ [L,R=301]

# bug 824126, 837942
RewriteRule ^/ports/qtmozilla(?:/(?:index.html)?)?$ https://wiki.mozilla.org/Qt [L,R=301]
RewriteRule ^/ports/os2/?$ https://wiki.mozilla.org/Ports/os2 [L,R=301]
RewriteCond %{REQUEST_URI} !^/ports/os2/gcc/?
RewriteCond %{REQUEST_URI} !^/ports/os2/selmail/?
RewriteRule ^/ports(.*)$ http://www-archive.mozilla.org/ports$1 [L,R=301]

# bug 832348
# need the RewriteCond to avoid prefetch.php conflicts.
RewriteCond %{THE_REQUEST} ^.+/index\.html\ HTTP
RewriteRule ^(.*)index\.html$ $1 [L,R=301]

# bug 1013082
RewriteRule ^/ja/?$ http://www.mozilla.jp/ [L,R]

# bug 1051686
RewriteRule ^/ja/firefox/organizations/?$ http://www.mozilla.jp/business/downloads/ [L,R=301]

## Redirect things to django!

# bug 1044184
RewriteRule ^/admin(/.*)?$ /b/admin$1 [PT]
RewriteRule ^/rna(/.*)?$ /b/rna$1 [PT]

# bug 797192, 892470
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?plugincheck(/?)$ /b/$1/plugincheck$2 [PT]

# bug 925551
RewriteRule ^/en-US/plugincheck/more_info.html$ /plugincheck/ [L,R=301]

# bug 835506
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?facebookapps/(.*)?$ /b/$1facebookapps/$2 [PT]

# bug 854561
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?projects/mozilla-based(\.html|/)?$ /$1about/mozilla-based/ [L,R=301]

# bug 851727
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?projects/powered-by(\.html|/)?$ /$1about/powered-by/ [L,R=301]

# bug 837883
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/firefox\.exe$ /$1 [NC,L,R=301]

# bug 821006
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/all(\.html)?$ /$1firefox/all/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/all/$ /b/$1firefox/all/ [PT]

# bug 1064416
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/interest-dashboard/$ /b/$1firefox/interest-dashboard/ [PT]

# bug 727561
RewriteRule ^/en-US/firefox/search(?:\.html)?$ /en-US/firefox/ [L,R=301]

# bug 957664
RewriteRule ^/en-US/press/awards(?:\.html)?$ https://blog.mozilla.org/press/awards/ [L,R=301]

# bug 860865, 1101220
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/all-(?:beta|rc)(?:\.html)?$ /firefox/beta/all/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/all-aurora(?:\.html)?$ /$1firefox/developer/all/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/aurora/(all|notes|system-requirements)/?$ /$1firefox/developer/$2/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/organizations/all(?:\.html)?$ /firefox/organizations/all/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/(developer|beta)/all(/?)$ /b/$1firefox/$2/all$3 [PT]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/organizations(.*)$ /b/$1firefox/organizations$2 [PT]

# bug 803345
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?apps(.*)$ /b/$1apps$2 [PT]

RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?persona(.*)$ /b/$1persona$2 [PT]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?b2g(.*)$ /b/$1b2g$2 [PT]

# bug 729329
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?mobile/sync.*$ /$1firefox/sync/ [L,R=301]

# bug 931042
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?collusion.*$ /$1lightbeam/ [L,R=301]

# bug 882845
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/toolkit/download-to-your-devices(.*)$ /$1firefox/ [L,R=301]

## Home Page
# Has to be this way because of old
# legacy platform url conflicts.
# bug 921564
RewriteRule ^/(ach|af|ak|an|ar|as|ast|az|be|bg|bn-BD|bn-IN|br|bs|ca|cs|csb|cy|da|de|dsb|el|en-GB|en-US|en-ZA|eo|es-AR|es-CL|es-ES|es-MX|et|eu|fa|ff|fi|fr|fy-NL|ga-IE|gd|gl|gu-IN|ha|he|hi-IN|hr|hsb|hu|hy-AM|id|ig|is|it|ja|ja-JP-mac|ka|kk|km|kn|ko|ku|lg|lij|lt|lv|mai|mk|ml|mn|mr|ms|my|nb-NO|nl|nn-NO|nso|oc|or|pa-IN|pl|pt-BR|pt-PT|rm|ro|ru|sah|sat|si|sk|sl|son|sq|sr|sv-SE|sw|ta|ta-LK|te|th|tr|uk|ur|uz|vi|wo|xh|zh-CN|zh-TW|zu)(/?)$ /b/$1$2 [PT]

# bug 987059, 1050149, 1072170
RewriteCond %{REQUEST_URI} !^/ja/about/manifesto
RewriteCond %{REQUEST_URI} !^/ja/about/legal
RewriteRule ^/ja/about(/?|/.+)$ http://www.mozilla.jp/about/mozilla/ [L,R=301]

# bug 1091977
RewriteRule ^/ja/contribute(/?|/.+)$ http://www.mozilla.jp/community/ [L,R=301]

# bug 889958
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?mission(/?)$ /b/$1mission$2 [PT]

# bug 793754, 1054437
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?contribute(/?|/.+)$ /b/$1contribute$2 [PT]

# bug 859564
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?contribute/(student|university)ambassadors(.*)$ /b/$1contribute/$2ambassadors$3 [PT]

RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?projects(/?)$ /b/$1projects$2 [PT]

# bug 1014823
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/releases/whatsnew(/?)$ /$1firefox/whatsnew/ [L,R=301]

RewriteRule ^/en-US/firefox/new(/?)$ /b/en-US/firefox/new$1 [PT]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/geolocation(/?)$ /b/$1firefox/geolocation$2 [PT]
RewriteRule ^/en-US/firefox/releases(/?)$ /b/en-US/firefox/releases$1 [PT]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/sync(/?)$ /b/$1firefox/sync$2 [PT]

# bug 1101984
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/hello(/?)$ /b/$1firefox/hello$2 [PT]

# bug 1071074
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/channel(/?)$ /b/$1firefox/channel$2 [PT]

# bug 1071318
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/mobile(/?)$ /b/$1firefox/mobile$2 [PT]

# bug 929775
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/update(.*)?$ /$1firefox/new/?utm_source=firefox-browser&utm_medium=firefox-browser&utm_campaign=firefox-update-redirect [L,R=301]

# bug 927442
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/community(/?)$ /$1contribute/ [L,R=301]

# bug 1044352
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/new(/?)$ /b/$1firefox/new$2 [PT]

# Bug 1006616
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?download/?$ /$1firefox/new/ [L,R=301]

# bug 957283
RewriteRule ^/(pt-BR)/firefox/speed(/?)$ /b/$1/firefox/speed$2 [PT]

# bug 796952, 915845, 915867
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/unsupported/(.*)$ /b/$1firefox/unsupported/$2 [PT]

# bug 988044
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/unsupported-systems\.html$ /$1firefox/unsupported-systems/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/unsupported-systems(.*)$ /b/$1firefox/unsupported-systems$2 [PT]

# Bug 1009247, 1101220
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?(firefox|mobile)/aurora/?$ /$1firefox/channel/#developer [NE,L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?(firefox|mobile)/beta/?$ /$1firefox/channel/#beta [NE,L,R=301]

# bug 960651
RewriteCond %{REQUEST_URI} !/unsupported
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?(firefox|mobile)/([^/]+)/details(/|/.+\.html)?$ /$1firefox/unsupported/details/ [L,R=301]

# bug 757117
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?webmaker(.*)$ /b/$1webmaker$2 [PT]

# bug 760194, 1074320
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?(firefox/)?dnt(.*)$ /b/$1$2dnt$3 [PT]

# bug 868182
RewriteCond %{QUERY_STRING} os=firefox-os
# the ? at the end means to remove the QS from the initial request.
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/mobile/faq/?$ /$1firefox/os/faq/? [L,R=301]

# bug 767614 superceeded by bug 957711 and 1003718
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?mobile(/?)$ /$1firefox/partners/ [L,R=302]

# bug 961010
RewriteRule ^/en-US/mobile/credits /credits/ [L,R=301]

# bug 801909
RewriteRule ^/credits(/faq)?(/)?$ /b/credits$1$2 [L,PT]

# bug 876668
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?mobile/customize(?:/.*)?$ /$1firefox/android/ [L,R=301]

# bug 773739
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?products(/?)$ /b/$1products$2 [PT]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox(/(?:\d+\.\d+\.?(?:\d+)?\.?(?:\d+)?(?:[a|b]?)(?:\d*)(?:pre)?(?:\d)?))?/whatsnew(/?)$ /b/$1firefox$2/whatsnew$3 [PT]

# bug 736934, 860865, 1101220
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?(firefox|mobile)/((?:beta|aurora|developer|organizations)/)?notes(/?)$ /b/$1$2/$3notes$4 [PT]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/((?:beta|aurora|organizations)/)?system-requirements(\.html)?$ /$1firefox/$2system-requirements/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/((?:beta|developer|organizations)/)?system-requirements/$ /b/$1firefox/$2system-requirements/ [PT]

# bug 778752
RewriteRule ^/en-US/firefox/channel/android(/?)$ /b/en-US/firefox/channel/android$1 [PT]

# bug 1059518
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/tiles(.*)$ /b/$1firefox/tiles$2 [PT]

# bug 784737
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/memory(.*)$ /b/$1firefox/memory$2 [PT]

RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?styleguide(.*)$ /b/$1styleguide$2 [PT]

RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/sms(.*)$ /b/$1firefox/sms$2 [PT]

RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?grants(.*)$ /b/$1grants$2 [PT] # bug 793181

# bug 897082
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?contact(.*)$ /b/$1contact$2 [PT]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?about/mozilla-spaces(.*)$ /$1contact/spaces/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?about/contact(.*)$ /$1contact/spaces/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?contribute/local(/?)$ /$1contact/communities/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?contribute/local/northamerica.html$ /$1contact/communities/north-america/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?contribute/local/europe.html$ /$1contact/communities/europe/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?contribute/local/latinamerica.html$ /$1contact/communities/latin-america/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?contribute/local/africamideast.html$ /$1contact/communities/africa-middle-east/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?contribute/local/asia.html$ /$1contact/communities/asia-south-pacific/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?contribute/local/southpole.html$ /$1contact/communities/antarctica/ [L,R=301]

# bug 875052
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?about/get-involved /$1contribute/ [L,R=301]

# request to ensure https is present for pluginchecks bug 795291
RewriteCond %{ENV:HTTPS} !on
RewriteRule ^/.*/plugincheck/ https://%{SERVER_NAME}%{REQUEST_URI} [L,R=301]

# bug 878871
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/os(.*)$ /b/$1firefox/os$2 [PT]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefoxos(.*)$ /$1firefox/os/ [NE,L,R=301]

# bug 797337
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?contribute/areas.html$ /b/$1contribute/areas.html [PT]

# bug 846362
RewriteRule ^/community/index.(de|fr|hr|sq).html$ /contribute/ [L,R=301]
RewriteRule ^/community/(index.html)?$ /contribute/ [L,R=301]

# bug 798453
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/installer-help(.*)$ /b/$1firefox/installer-help$2 [PT]

# bug 801705
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?gameon(.*)$ /b/$1gameon$2 [PT]

# bug 799767
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?book(.*)$ /b/$1book$2 [PT]

# bug 800461
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/brand(.*)$ /b/$1firefox/brand$2 [PT]

# bug 807323
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?foundation/identity-guidelines(.*)$ /b/$1foundation/identity-guidelines$2 [PT]

# bug 905802
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?legal/fraud-report(/?)$ /b/$1legal/fraud-report$2 [PT]

# bug 811787
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?foundation/annualreport/2011(.*)$ /b/$1foundation/annualreport/2011$2 [PT]

# bug 928120
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?foundation/annualreport/2012(.*)$ /b/$1foundation/annualreport/2012$2 [PT]

# bug 815731 /ITU/
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?ITU(.*)$ /b/$1ITU$2 [PT]

# bug 821838
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?tabzilla/(.*)$ /b/$1tabzilla/$2 [PT]

# bug 821937
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?m/privacy.html$ /b/$1m/privacy.html [PT]

# bug 683375
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?research(.*)$ /b/$1research$2 [PT]

# bug 822817
RewriteRule ^/telemetry/?$ /b/telemetry/ [PT]

# bug 829091
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/partners(.*)$ /b/$1firefox/partners$2 [PT]

# bug 831810 & 1142583
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?mwc/?$ /$1firefox/partners/?utm_source=mozilla.org&utm_medium=referral&utm_campaign=mwc-redirect [NC,L,R=302]

# bug 957763
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?mwc(/?)$ /b/$1mwc$2 [PT]

# bug 939305
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox(/(?:\d+\.\d+\.?(?:\d+)?\.?(?:\d+)?(?:[a|b]?)(?:\d*)(?:pre)?(?:\d)?))?/firstrun(/?)$ /b/$1firefox$2/firstrun$3 [PT]
# bug 1003703, 1009630
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox(/.+)/firstrun/eu/?$ /$1firefox$2/firstrun/?utm_source=direct&utm_medium=none&utm_campaign=redirect&utm_content=eu-firstrun-redirect [L,R=301]

# bug 748503
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?projects/firefox/([^/]+)a[0-9]+/(firstrun|whatsnew)(.*)$ /$1firefox/nightly/firstrun$4 [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/nightly/firstrun(.*)$ /b/$1firefox/nightly/firstrun$2 [PT]

# bug 840814
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?projects/firefox(/(?:\d+\.\d+\.?(?:\d+)?\.?(?:\d+)?(?:[a|b]?)(?:\d*)(?:pre)?(?:\d)?))(/(?:firstrun|whatsnew))(/.*)?$ /$1firefox$2$3$4 [L,R=301]

# bug 845983
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?metrofirefox(/.*)? /$1firefox$2 [L,R=301]

# bug 878926
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefoxflicks/?(.*) https://firefoxflicks.mozilla.org/$1$2 [L,R=301]

# bug 849426
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?about/history(\.html)?$ /$1about/history/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?about/bookmarks.html$ https://wiki.mozilla.org/Historical_Documents [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?about/timeline.html$ https://wiki.mozilla.org/Timeline [L,R=301]

# bug 1016400
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?about/careers.html$ https://careers.mozilla.org/ [QSA,L,R=301]

# bug 861243 and bug 869489
RewriteRule ^/about/manifesto\.html$ /about/manifesto/ [L,R=301]
RewriteRule ^/about/manifesto\.(.*)\.html$ /$1/about/manifesto/ [L,R=301]

# bug 856077
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?projects/toolkit(/?)$ https://developer.mozilla.org/docs/Toolkit_API [L,R=301]

# bug 877165
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/connect.*$ / [L,R=301]

# bug 657049
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/accountmanager/?$ /$1persona/ [L,R=301]

# bug 841846
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/nightly(/?)$ https://nightly.mozilla.org [L,R=302]


# bug 748503
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/nightly/firstrun(.*)$ /b/$1firefox/nightly/firstrun$2 [PT]

# bug 860532 - Reidrects for governance pages
RewriteRule ^/about/governance\.html$ /about/governance/ [L,R=301]
RewriteRule ^/about/roles\.html$ /about/governance/roles/ [L,R=301]
RewriteRule ^/about/organizations\.html$ /about/governance/organizations/ [L,R=301]

# bug 876233
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?about/participate/?$ /$1contribute/ [L,R=301]

# bug 790784
# NB: The /foundation/privacy-policy.html redirect must appear before the
# foundation redirects added with bug 724633. Otherwise, the address will first
# be prefixed with a locale, and this redirect will not work.
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?privacy-policy(?:\.html)?$ /$1privacy/websites/ [L,R=301]
RewriteRule ^/foundation/privacy-policy\.html$ /privacy/websites/ [L,R=301]
RewriteRule ^/about/policies/privacy-policy\.html$ /privacy/websites/ [L,R=301]
RewriteRule ^/en-US/privacy-policy\.pdf$ https://static.mozilla.com/moco/en-US/pdf/mozilla_privacypolicy.pdf [L,R=301]

# bug 1074354
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?legal/?$ /$1about/legal/ [L,R=301]

# bug 963816
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?legal/privacy/?$ /$1privacy/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?legal/privacy/firefox(?:\.html)?$ /$1privacy/firefox/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?legal/privacy/oct-2006  /$1privacy/archive/firefox/2006-10/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?legal/privacy/june-2008 /$1privacy/archive/firefox/2008-06/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?legal/privacy/jan-2009  /$1privacy/archive/firefox/2009-01/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?legal/privacy/sept-2009 /$1privacy/archive/firefox/2009-09/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?legal/privacy/jan-2010  /$1privacy/archive/firefox/2010-01/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?legal/privacy/dec-2010  /$1privacy/archive/firefox/2010-12/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?legal/privacy/june-2011 /$1privacy/archive/firefox/2011-06/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?legal/privacy/june-2012 /$1privacy/archive/firefox/2012-06/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?legal/privacy/sept-2012 /$1privacy/archive/firefox/2012-09/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?legal/privacy/dec-2012  /$1privacy/archive/firefox/2012-12/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?legal/privacy/firefox-third-party /$1privacy/archive/firefox/third-party/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?legal/privacy/notices-firefox /$1legal/firefox/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?privacy/policies/(facebook|firefox-os|websites)/?$ /$1privacy/$2/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?privacy(.*)$ /b/$1privacy$2 [PT]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?legal/firefox(/?)$ /b/$1legal/firefox$2 [PT]

# bug 1034859
RewriteRule ^/en-US/about/buttons/(.*) /media/img/careers/buttons/$1 [L,R=301]

# bug 960689, 1013349, 896474
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?about/legal\.html$ /$1about/legal/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?about/partnerships\.html$ /$1about/partnerships/ [L,R=301]

# bug 809426
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?legal/eula(/?)$ /b/$1legal/eula$2 [PT]

# bug 960543
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/2.0/eula(?:.*) /$1legal/eula/firefox-2/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/3.0/eula(?:.*) /$1legal/eula/firefox-3/ [L,R=301]
RewriteRule ^/en-US/legal/eula(.*)$ /b/en-US/legal/eula$1 [PT]

# bug 724633 - Porting foundation pages
# Add redirects for the pdfs that were under /foundation/documents/
# that will now be served from static.mozilla.com/foundation/documents/
# (The links within the foundation pages have been updated, but there are
# probably many links to them from other pages and sites that need to keep
# working.)
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?foundation/documents/([^/]+).pdf$ https://static.mozilla.com/foundation/documents/$2.pdf [NC,L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?foundation/donate_form.pdf$ https://static.mozilla.com/foundation/documents/donate_form.pdf [NC,L,R=301]

# openwebfund/ and openwebfund/index.html redirect to another site.  Careful because
# there are other pages under openwebfund that still need to be served from Bedrock.
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?foundation/openwebfund/(index.html)?$ https://sendto.mozilla.org/page/contribute/join-mozilla?source=owf_redirect [NC,L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?foundation/donate\.html$ https://sendto.mozilla.org/page/contribute/openwebfund [NC,L,R=301]

# FIXUPs for changing foo/bar.html to foo/bar/
# Redirect foundation/foo.html to foundation/foo/, with a redirect for the nice search engines
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?foundation/(about|careers|licensing|moco|mocosc).html$ /$1foundation/$2/ [NC,L,R=301]
# Redirect foundation/anything/foo.html to foundation/anything/foo/, with a redirect for the nice search engines
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?foundation/((annualreport|documents|feed-icon-guidelines|licensing|openwebfund|trademarks)/.*).html$ /$1foundation/$2/ [NC,L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?foundation/documents/(index|mozilla-200.-financial-faq).html$ /$1foundation/$2/ [NC,L,R=301]

# bug 442671
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?foundation/trademarks/l10n-policy(/?)$ /$1foundation/trademarks/ [L,R=301]

# bug 960689
RewriteRule ^/en-US/legal/bylaws_amendment_1(?:\.html)?$ /foundation/documents/bylaws-amendment-1/ [L,R=301]
RewriteRule ^/en-US/legal/bylaws_amendment_2(?:\.html)?$ /foundation/documents/bylaws-amendment-2/ [L,R=301]
RewriteRule ^/en-US/legal/articles(?:\.html)?$ /foundation/documents/articles-of-incorporation/ [L,R=301]
RewriteRule ^/en-US/legal/amendment(?:\.html)?$ /foundation/documents/articles-of-incorporation/amendment/ [L,R=301]
RewriteRule ^/en-US/legal/bylaws(?:\.html)?$ /foundation/documents/bylaws/ [L,R=301]


# Add /b to all foundation URLs to serve them from Bedrock.
# (The old foundation pages had no locale in the URL.
# But when the rewritten locale-less URLs hit Bedrock, Bedrock will return
# a redirect with the locale added. So we need to make sure both kinds of
# URL end up in Bedrock.)
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?foundation(/.*)?$ /b/$1foundation$2 [PT]

# bug 724682
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?projects/mathml/demo/texvsmml.html$ https://developer.mozilla.org/docs/Mozilla_MathML_Project/MathML_Torture_Test [L,R=301]
RewriteRule ^/projects/mathml(?:/(?:index.html|demo(?:/(?:index.html)?)?)?)?$ https://developer.mozilla.org/en-US/docs/Mozilla/MathML_Project [L,R=301]
RewriteRule ^/projects/mathml/fonts(?:/(?:index.html)?)?$ https://developer.mozilla.org/Mozilla_MathML_Project/Fonts [L,R=301]
RewriteRule ^/projects/mathml/screenshots(?:/(?:index.html)?)?$ https://developer.mozilla.org/Mozilla_MathML_Project/Screenshots [L,R=301]

# bug 878039
RewriteRule ^/access/architecture.html$ https://developer.mozilla.org/en-US/docs/Mozilla/Accessibility/Accessibility_architecture [L,R=301]
RewriteRule ^/access/at-vendors.html$ https://developer.mozilla.org/en-US/docs/Mozilla/Accessibility/Information_for_Assistive_Technology_Vendors [L,R=301]
RewriteRule ^/access/authors.html$ https://developer.mozilla.org/en-US/docs/Web/Accessibility/Information_for_Web_authors [L,R=301]
RewriteRule ^/access/core-developers.html$ https://developer.mozilla.org/en-US/docs/Mozilla/Accessibility/Accessibility_Information_for_Core_Gecko_Developer [L,R=301]
RewriteRule ^/access/evaluators.html$ https://developer.mozilla.org/en-US/docs/Mozilla/Accessibility/Information_for_Governments_and_Other_Organization [L,R=301]
RewriteRule ^/access/event-flow.html$ https://developer.mozilla.org/en-US/docs/Mozilla/Accessibility/Event_Process_Procedure [L,R=301]
RewriteRule ^/access/external-developers.html$ https://developer.mozilla.org/en-US/docs/Mozilla/Accessibility/Information_for_External_Developers_Dealing_with_A#community [L,R=301]
RewriteRule ^/access/features.html$ https://developer.mozilla.org/en-US/docs/Mozilla/Accessibility/Accessibility_Features_in_Firefox [L,R=301]
RewriteRule ^/access/highlevel.html$ https://developer.mozilla.org/en-US/docs/Mozilla/Accessibility/CSUN_Firefox_Materials [L,R=301]
RewriteRule ^/access/platform-apis.html$ https://developer.mozilla.org/en-US/docs/Mozilla/Accessibility/Accessibility_API_cross-reference#Accessible_Roles [L,R=301]
RewriteRule ^/access/plugins-work.html$ https://developer.mozilla.org/en-US/docs/Mozilla/Accessibility/Mozilla_Plugin_Accessibility [L,R=301]
RewriteRule ^/access/prefs-and-apis.html$ https://developer.mozilla.org/en-US/docs/Mozilla/Accessibility/Embedding_API_for_Accessibility [L,R=301]
RewriteRule ^/access/resources.html$ https://developer.mozilla.org/en-US/docs/Mozilla/Accessibility/Links_and_Resources [L,R=301]
RewriteRule ^/access/section508.html$ https://developer.mozilla.org/en-US/docs/Mozilla/Accessibility/Mozilla_s_Section_508_Compliance [L,R=301]
RewriteRule ^/access/today.html$ https://developer.mozilla.org/en-US/docs/Mozilla/Accessibility/Software_accessibility_today [L,R=301]
RewriteRule ^/access/toolkit-checklist.html$ https://developer.mozilla.org/en-US/docs/Mozilla/Accessibility/What_needs_to_be_done_when_building_new_toolkits [L,R=301]
RewriteRule ^/access/ui-developers.html$ https://developer.mozilla.org/en-US/docs/Mozilla/Accessibility/Accessibility_information_for_UI_designers [L,R=301]
RewriteRule ^/access/users.html$ https://developer.mozilla.org/en-US/docs/Mozilla/Accessibility/Information_for_users [L,R=301]
RewriteRule ^/access/w3c-uaag.html$ https://developer.mozilla.org/en-US/docs/Mozilla/Accessibility/UAAG_evaluation_report [L,R=301]
RewriteRule ^/access/w4a.html$ https://developer.mozilla.org/en-US/docs/Mozilla/Accessibility/W4A [L,R=301]
RewriteRule ^/access/windows/at-apis.html$ https://developer.mozilla.org/en-US/docs/Mozilla/Accessibility/Gecko_info_for_Windows_accessibility_vendors [L,R=301]
RewriteRule ^/access/windows/msaa-server.html$ https://developer.mozilla.org/en-US/docs/Web/Accessibility/Implementing_MSAA_server [L,R=301]
RewriteRule ^/access/windows/zoomtext.html$ https://developer.mozilla.org/en-US/docs/Mozilla/Accessibility/ZoomText [L,R=301]

# bug 869495
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/os/releasenotes/1.0.1(.*)$ /b/$1firefox/os/releasenotes/1.0.1$2 [PT]
# bug 912101
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/os/releasenotes/1.1(.*)$ /b/$1firefox/os/releasenotes/1.1$2 [PT]

# bug 858315
RewriteRule ^/projects/devpreview/firstrun(?:/(?:index.html)?)?$ /firefox/firstrun/ [L,R=301]
RewriteRule ^/projects/devpreview/(.*)$ http://website-archive.mozilla.org/www.mozilla.org/devpreview_releasenotes/projects/devpreview/$1 [L,R=301]

# bug 947890, 1069902
RewriteRule ^/en-US/firefox/releases/1\.(.*)$ http://website-archive.mozilla.org/www.mozilla.org/firefox_releasenotes/en-US/firefox/releases/1.$1 [L,R=301]
RewriteRule ^/en-US/firefox/releases/0\.(.*)$ http://website-archive.mozilla.org/www.mozilla.org/firefox_releasenotes/en-US/firefox/releases/0.$1 [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2}(?:-mac)?)?/)(firefox|mobile)/(\d)\.(.*)/releasenotes(.*)$ http://website-archive.mozilla.org/www.mozilla.org/firefox_releasenotes/en-US/$2/$3.$4/releasenotes$5 [L,R=301]

# bug 988746, 989423, 994186
RewriteRule ^/(\w{2,3}(?:-\w{2}(?:-mac)?)?/)?(firefox|mobile)/(2[38]\.0(?:\.\d)?)/releasenotes(/)?$ /b/$1$2/$3/releasenotes$4 [L,PT]
RewriteRule ^/(\w{2,3}(?:-\w{2}(?:-mac)?)?/)?(firefox|mobile)/(29\.0(?:beta|\.\d)?)/releasenotes(/)?$ /b/$1$2/$3/releasenotes$4 [L,PT]
RewriteRule ^/(\w{2,3}(?:-\w{2}(?:-mac)?)?/)?(firefox|mobile)/([3-9]\d\.\d(?:a2|beta|\.\d)?)/(aurora|release)notes(/)?$ /b/$1$2/$3/$4notes$5 [L,PT]

# bug 1081917, 1029829, 1029838
RewriteRule ^/(\w{2,3}(?:-\w{2}(?:-mac)?)?/)?thunderbird/([3-9]\d\.\d(?:a2|beta|\.\d)?)/releasenotes(/)?$ /b/$1thunderbird/$2/releasenotes$3 [L,PT]
RewriteRule ^/(\w{2,3}(?:-\w{2}(?:-mac)?)?/)?thunderbird/([3-9]\d\.\d(?:a2|beta|\.\d)?)/system-requirements(/)?$ /b/$1thunderbird/$2/system-requirements$3 [L,PT]
RewriteRule ^/(\w{2,3}(?:-\w{2}(?:-mac)?)?/)?thunderbird/releases(/)?$ /b/$1thunderbird/releases$2 [L,PT]
RewriteRule ^/(\w{2,3}(?:-\w{2}(?:-mac)?)?/)?thunderbird/releases/(.*)$ http://website-archive.mozilla.org/www.mozilla.org/thunderbird_releasenotes/en-US/thunderbird/releases/$2 [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2}(?:-mac)?)?/)?thunderbird/(.*)/releasenotes(.*)$ http://website-archive.mozilla.org/www.mozilla.org/thunderbird_releasenotes/en-US/thunderbird/$2/releasenotes$3 [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2}(?:-mac)?)?/)?thunderbird/(.*)/system-requirements(.*)$ http://website-archive.mozilla.org/www.mozilla.org/thunderbird_releasenotes/en-US/thunderbird/$2/system-requirements$3 [L,R=301]

# bug 1103396 for en-US, bug 1115066 for other locales
RewriteRule ^/(bg|ca|cs|da|de|dsb|el|en-GB|en-US|es-AR|es-ES|et|eu|fr|fy-NL|ga-IE|gd|hr|hsb|hu|hy-AM|id|is|it|ja|ko|lt|nl|pl|pt-BR|pt-PT|rm|ru|si|sk|sl|sq|sr|sv-SE|tr|uk|zh-CN|zh-TW)/thunderbird/release/start(/)?$ /b/$1/thunderbird/release/start$2 [L,PT]

# bug 1090468
RewriteRule ^/security/older-alerts\.html http://website-archive.mozilla.org/www.mozilla.org/security/security/older-alerts.html [L,R=301]
RewriteRule ^/security/security-announcement\.html http://website-archive.mozilla.org/www.mozilla.org/security/security/security-announcement.html [L,R=301]
RewriteRule ^/security/iSECPartners_Phishing\.pdf http://website-archive.mozilla.org/www.mozilla.org/security/security/iSECPartners_Phishing.pdf [L,R=301]
RewriteRule ^/security/phishing-test-results\.html http://website-archive.mozilla.org/www.mozilla.org/security/security/phishing-test-results.html [L,R=301]
RewriteRule ^/security/phishing-test\.html http://website-archive.mozilla.org/www.mozilla.org/security/security/phishing-test.html [L,R=301]

# bug 1001238, 1025056
RewriteRule ^/(\w{2,3}(?:-\w{2}(?:-mac)?)?/)?firefox/(24\.[5678]\.\d)/releasenotes(/)?$ /b/$1firefox/$2/releasenotes$3 [L,PT]

# bug 1041712, 1069335, 1069902
RewriteRule ^/(\w{2,3}(?:-\w{2}(?:-mac)?)?/)(firefox|mobile)/([0-9]|1[0-9]|2[0-8])\.(\d+(?:beta|a2|\.\d+)?)/(release|aurora)notes/(.*)$ http://website-archive.mozilla.org/www.mozilla.org/firefox_releasenotes/en-US/$2/$3.$4/$5notes/$6 [L,R=301]

# bug 957242
RewriteRule ^/(\w{2,3}(?:-\w{2}(?:-mac)?)?/)?firefox/(.*)/system-requirements(/)?$ /b/$1firefox/$2/system-requirements$3 [PT]

# bug 1017564
RewriteRule ^/en-US/mobile/.*/system-requirements/?$ https://support.mozilla.org/kb/will-firefox-work-my-mobile-device [L,R=301]

# bug 818323
RewriteRule ^/projects/security/known-vulnerabilities.html$ /security/known-vulnerabilities/ [L,R=301]
RewriteRule ^/projects/security/older-vulnerabilities.html$ /security/known-vulnerabilities/older-vulnerabilities.html [L,R=301]

# bug 926629
RewriteRule ^/en-US/newsletter/about_mobile(?:/(?:index.html)?)?$ /en-US/newsletter/ [L,R=301]
RewriteRule ^/en-US/newsletter/about_mozilla(?:/(?:index.html)?)?$ /en-US/contribute/ [L,R=301]
RewriteRule ^/en-US/newsletter/new(?:/(?:index.html)?)?$ /en-US/newsletter/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?newsletter(.*)$ /b/$1newsletter$2 [PT]

# bug 892716
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox(/)?$ /b/$1firefox$2 [PT]

# bug 1071922
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/developer(.*)$ /b/$1firefox/developer$2 [PT]

# bug 818321
RewriteRule ^/projects/security/tld-idn-policy-list.html$ /about/governance/policies/security-group/tld-idn/ [L,R=301]
RewriteRule ^/projects/security/membership-policy.html$ /about/governance/policies/security-group/membership/ [L,R=301]
RewriteRule ^/projects/security/secgrouplist.html$ /about/governance/policies/security-group/ [L,R=301]
RewriteRule ^/projects/security/security-bugs-policy.html$ /about/governance/policies/security-group/bugs/ [L,R=301]

# bug 818316, 1128579
RewriteRule ^/projects/security/certs(?:/(?:index.html)?)?$ /about/governance/policies/security-group/certs/ [L,R=301]
RewriteRule ^/projects/security/certs/included(?:/(?:index.html)?)?$ https://wiki.mozilla.org/CA:IncludedCAs [L,R=301]
RewriteRule ^/projects/security/certs/pending(?:/(?:index.html)?)?$ https://wiki.mozilla.org/CA:PendingCAs [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?about/governance/policies/security-group/certs/included(?:/(?:index.html)?)?$ https://wiki.mozilla.org/CA:IncludedCAs [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?about/governance/policies/security-group/certs/pending(?:/(?:index.html)?)?$ https://wiki.mozilla.org/CA:PendingCAs [L,R=301]
RewriteRule ^/projects/security/certs/policy(?:/(?:index.html)?)?$ /about/governance/policies/security-group/certs/policy/ [L,R=301]
RewriteRule ^/projects/security/certs/policy/EnforcementPolicy.html /about/governance/policies/security-group/certs/policy/enforcement/ [L,R=301]
RewriteRule ^/projects/security/certs/policy/MaintenancePolicy.html /about/governance/policies/security-group/certs/policy/maintenance/ [L,R=301]
RewriteRule ^/projects/security/certs/policy/InclusionPolicy.html /about/governance/policies/security-group/certs/policy/inclusion/ [L,R=301]

# bug 903089
RewriteRule ^/robots.txt$ /b/robots.txt [PT]

# bug 933311
RewriteRule ^/humans.txt$ /b/humans.txt [L,PT]

# bug 1003743
RewriteRule ^/info\.txt$ /b/info.txt [L,PT]

# bug 1068931
RewriteRule ^/advocacy/?$ https://advocacy.mozilla.org/ [L,R=301]

#bug 887426
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?about/policies(/?)$ /$1about/governance/policies/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?about/policies/participation.html$ /$1about/governance/policies/participation/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?about/policies/policies.html$ /$1about/governance/policies/ [L,R=301]

# bug 882923
RewriteRule ^/en-US/opt-out.html$ /privacy/websites/#user-choices [NE,L,R=301]

# bug 884933
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/mobile/platforms(/?)$ https://support.mozilla.org/kb/will-firefox-work-my-mobile-device [L,R=301]

# bug 876581
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/phishing-protection(/?)$ https://support.mozilla.org/kb/how-does-phishing-and-malware-protection-work [L,R=301]

# bug 1006079
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?mobile/home/?(?:index.html)?$ https://blog.mozilla.org/services/2012/08/31/retiring-firefox-home/ [L,R=301]

# bug 949562
RewriteRule ^/en-US/mobile/home/1\.0/releasenotes(?:/(?:index.html)?)?$ http://website-archive.mozilla.org/www.mozilla.org/firefox_home/en-US/mobile/home/1.0/releasenotes/  [L,R=301]
RewriteRule ^/en-US/mobile/home/1\.0\.2/releasenotes(?:/(?:index.html)?)?$ http://website-archive.mozilla.org/www.mozilla.org/firefox_home/en-US/mobile/home/1.0.2/releasenotes/  [L,R=301]
RewriteRule ^/en-US/mobile/home/faq(?:/(?:index.html)?)?$ http://website-archive.mozilla.org/www.mozilla.org/firefox_home/en-US/mobile/home/faq/  [L,R=301]

# bug 960064
RewriteRule ^/en-US/firefox/(vpat-[\.1-5]+)(?:\.html)?$ http://website-archive.mozilla.org/www.mozilla.org/firefox_vpat/firefox-$1.html [L,R=301]
RewriteRule ^/en-US/firefox/vpat(?:\.html)? http://website-archive.mozilla.org/www.mozilla.org/firefox_vpat/firefox-vpat-3.html [L,R=301]

# bug 924687
RewriteRule ^/en-US/opportunities(?:/(?:index.html)?)?$ https://careers.mozilla.org/ [L,R=301]

# bug 926629
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?lightbeam(/?.*)$ /b/$1lightbeam$2 [PT]

# bug 675031
RewriteRule ^/projects/fennec/(.*) http://website-archive.mozilla.org/www.mozilla.org/fennec_releasenotes/projects/fennec/$1 [L,R=301]

# bug 957637
RewriteRule ^/en-US/sopa/ https://blog.mozilla.org/blog/2012/01/19/firefox-users-engage-congress-sopa-strike-stats/ [L,R=301]

# Bug 608370, 957664
RewriteRule ^/en-US/press/kit(?:.*\.html|s/?)$ https://blog.mozilla.org/press/kits/ [R=301,L]

# bug 877198
RewriteRule ^/en-US/press/news.html http://blog.mozilla.org/press/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2003-10-15.html http://blog.mozilla.org/press/2003/10/mozilla-foundation-launches-new-web-browser-and-end-user-services/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2004-02-09.html http://blog.mozilla.org/press/2004/02/new-round-of-releases-extends-mozilla-projects-standards-based-open-source-offerings/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2004-02-17.html http://blog.mozilla.org/press/2004/02/mozilla-gains-stronghold-in-europe/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2004-02-26.html https://blog.mozilla.org/press/2004/02/mozilla-foundation-rallies-supporters-to-take-back-the-web/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2004-05-03.html http://blog.mozilla.org/press/2004/05/mozilla-foundation-releases-thunderbird-0-6/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2004-06-15.html http://blog.mozilla.org/press/2004/06/mozilla-reloads-firefox/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2004-06-16.html http://blog.mozilla.org/press/2004/06/mozilla-foundation-releases-thunderbird-0-7/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2004-06-30.html http://blog.mozilla.org/press/2013/11/mozilla-foundation-announces-more-open-scriptable-plugins/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2004-08-02.html http://blog.mozilla.org/press/2004/08/mozilla-foundation-announces-security-bug-bounty-program/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2004-08-10.html http://blog.mozilla.org/press/2004/08/mozilla-foundation-announces-xforms-development-project/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2004-08-18.html http://blog.mozilla.org/press/2004/08/mozilla-affiliate-in-japan-kicks-off/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2004-09-14-01.html http://blog.mozilla.org/press/2004/09/mozilla-foundation-announces-first-payments-of-security-bug-bounty-program-further-strengthens-browser-security/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2004-09-14-02.html http://blog.mozilla.org/press/2013/11/firefox-preview-release-and-thunderbird-0-8-released/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2004-09-20.html http://blog.mozilla.org/press/2004/09/mozilla-firefox-preview-release-hits-one-million-downloads-in-first-four-days-of-availability/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2004-10-01-02.html http://blog.mozilla.org/press/2004/10/important-security-update-for-firefox-available/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2004-11-09.html http://blog.mozilla.org/press/2004/11/mozilla-foundation-releases-the-highly-anticipated-mozilla-firefox-1-0-web-browser/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2004-11-22.html http://blog.mozilla.org/press/2004/11/important-update-to-german-language-version-of-firefox-1-0/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2004-12-15.html http://blog.mozilla.org/press/2004/12/mozilla-foundation-places-two-page-advocacy-ad-in-the-new-york-times/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2004-12-7.html http://blog.mozilla.org/press/2004/12/mozilla-thunderbird-1-0-email-client-has-landed/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2005-01-07.html http://blog.mozilla.org/press/2005/01/mozilla-firefox-and-thunderbird-to-support-new-open-standard-platform-for-usb-drives/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2005-02-02.html http://blog.mozilla.org/press/2005/02/mozilla-foundation-announces-beta-release-of-xforms-1-0-recommendation/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2005-02-16.html http://blog.mozilla.org/press/2005/01/mozilla-firefox-and-thunderbird-to-support-new-open-standard-platform-for-usb-drives/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2005-02-24.html http://blog.mozilla.org/press/2005/02/mozilla-foundation-announces-update-to-firefox/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2005-03-04.html http://blog.mozilla.org/press/2005/03/mozilla-foundation-expands-with-launch-of-mozilla-china/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2005-03-23.html http://blog.mozilla.org/press/2005/03/mozilla-foundation-releases-security-update-to-firefox/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2005-03-28.html http://blog.mozilla.org/press/2005/03/mozilla-foundation-awards-bug-bounties/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2005-05-13.html http://blog.mozilla.org/press/2005/05/mozilla-foundation-co-hosts-europes-leading-xml-and-web-developer-conference/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2005-07-28.html http://blog.mozilla.org/press/2005/07/mozilla-headlines-two-key-open-source-development-conferences-in-august/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2005-08-03.html http://blog.mozilla.org/press/2005/08/mozilla-foundation-forms-new-organization-to-further-the-creation-of-free-open-source-internet-software-including-the-award-winning-mozilla-firefox-browser/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2005-10-03.html http://blog.mozilla.org/press/2005/10/mozilla-launches-beta-of-comprehensive-online-developer-center/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2005-10-19.html http://blog.mozilla.org/press/2005/10/firefox-surpasses-100-million-downloads/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2005-11-29.html http://blog.mozilla.org/press/2005/11/mozilla-introduces-firefox-1-5-and-ups-the-ante-in-web-browsing/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2005-11-3.html http://blog.mozilla.org/press/2005/11/mozilla-kicks-off-extend-firefox-competition/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2005-11-30.html http://blog.mozilla.org/press/2005/11/firefox-1-5-adds-answers-com-for-quick-reference/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2005-12-2.html http://blog.mozilla.org/press/2005/12/mozilla-launches-firefox-flicks-campaign/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2005-12-22.html http://blog.mozilla.org/press/2005/12/mozilla-launches-firefox-flicks-ad-contest/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2006-01-12.html http://blog.mozilla.org/press/2006/01/mozilla-releases-thunderbird-1-5-email-client/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2006-01-24.html http://blog.mozilla.org/press/2006/01/firefox-1-5-adoption-rising-as-browser-garners-acclaim/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2006-01-25.html http://blog.mozilla.org/press/2006/01/indie-film-all-stars-foin-firefox-flicks-crew/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2006-02-03.html http://blog.mozilla.org/press/2006/02/mozilla-releases-preview-of-application-framework-for-development-of-cross-platform-internet-client-applications/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2006-03-02.html http://blog.mozilla.org/press/2006/03/mozilla-announces-winners-of-extend-firefox-competition/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2006-04-12.html http://blog.mozilla.org/press/2006/04/mozilla-showcases-first-round-of-community-produced-firefox-flicks-videos/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2006-04-18.html http://blog.mozilla.org/press/2006/04/mozilla-receives-over-280-community-produced-videos-for-firefox-flicks/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2006-04-27.html http://blog.mozilla.org/press/2006/04/firefox-flicks-video-contest-winners-announced/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2006-06-14.html http://blog.mozilla.org/press/2006/06/mozilla-feeds-soccer-fans-passion-with-new-firefox-add-on/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2006-10-11.html http://blog.mozilla.org/press/2006/10/qualcomm-launches-project-in-collaboration-with-mozilla-foundation-to-develop-open-source-version-of-eudora-email-program/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2006-10-24-02.html http://blog.mozilla.org/press/2006/10/firefox-moving-the-internet-forward/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2006-10-24.html http://blog.mozilla.org/press/2006/10/mozilla-releases-major-update-to-firefox-and-raises-the-bar-for-online-experience/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2006-11-07.html http://blog.mozilla.org/press/2006/11/adobe-and-mozilla-foundation-to-open-source-flash-player-scripting-engine/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2006-12-04.html http://blog.mozilla.org/press/2006/12/the-world-economic-forum-announces-technology-pioneers-2007-mozilla-selected/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2006-12-11.html http://blog.mozilla.org/press/2006/12/mozilla-firefox-headed-for-primetime/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2007-02-07.html http://blog.mozilla.org/press/2007/02/kodak-and-mozilla-join-forces-to-make-sharing-photos-even-easier/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2007-03-27.html http://blog.mozilla.org/press/2007/03/mozilla-launches-new-firefox-add-ons-web-site/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2007-03-28.html http://blog.mozilla.org/press/2007/03/mozilla-and-ebay-working-together-to-make-the-auction-experience-easier-for-firefox-users-in-france-germany-and-the-uk/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2007-04-19.html http://blog.mozilla.org/press/2007/04/mozilla-thunderbird-2-soars-to-new-heights/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2007-05-16.html http://blog.mozilla.org/press/2007/05/united-nations-agency-awards-mozilla-world-information-society-award/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2007-07-04.html http://blog.mozilla.org/press/2007/07/mozilla-and-ebay-launch-firefox-companion-for-ebay-users/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2007-08-10.html http://blog.mozilla.org/press/2007/08/mozilla-to-host-24-hour-worldwide-community-event/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2007-08-28.html http://blog.mozilla.org/press/2007/08/mozilla-welcomes-students-back-to-school-with-firefox-campus-edition/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2007-09-17-faq.html http://blog.mozilla.org/press/2007/09/mozilla-launches-internet-mail-and-communications-initiative/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2007-09-17.html http://blog.mozilla.org/press/2007/09/mozilla-launches-internet-mail-and-communications-initiative/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2008-01-07-faq.html http://blog.mozilla.org/press/2008/01/mozilla-appoints-john-lilly-as-chief-executive-officer/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2008-01-07.html http://blog.mozilla.org/press/2008/01/mozilla-appoints-john-lilly-as-chief-executive-officer/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2008-02-19-faq.html http://blog.mozilla.org/press/2008/02/mozilla-messaging-starts-up-operations/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2008-02-19.html http://blog.mozilla.org/press/2008/02/mozilla-messaging-starts-up-operations/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2008-05-28.html http://blog.mozilla.org/press/2008/05/mozilla-aims-to-set-guinness-world-record-on-firefox-3-download-day/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2008-06-17-faq.html http://blog.mozilla.org/press/2008/06/mozilla-releases-firefox-3-and-redefines-the-web-experience/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2008-06-17.html http://blog.mozilla.org/press/2008/06/mozilla-releases-firefox-3-and-redefines-the-web-experience/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2008-07-02.html http://blog.mozilla.org/press/2008/07/mozilla-sets-new-guinness-world-record-with-firefox-3-downloads/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2008-11-18.html http://blog.mozilla.org/press/2008/11/mozilla-launches-fashion-your-firefox-and-makes-it-easy-to-customize-the-browsing-experience/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2008-12-03.html http://blog.mozilla.org/press/2008/12/mozilla-and-zazzle-announce-strategic-relationship-for-apparel-on-demand/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2009-03-31.html http://blog.mozilla.org/press/2009/03/­­­­mozilla-adds-style-and-star-power-to-firefox-with-new-personas/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2009-06-30-faq.html http://blog.mozilla.org/press/2009/04/mozilla-advances-the-web-with-firefox-3-5/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-2009-06-30.html http://blog.mozilla.org/press/2009/04/mozilla-advances-the-web-with-firefox-3-5/ [L,R=301]
RewriteRule ^/en-US/press/mozilla-foundation.html http://blog.mozilla.org/press/2003/07/mozilla-org-announces-launch-of-the-mozilla-foundation-to-lead-open-source-browser-efforts/ [L,R=301]
RewriteRule ^/en-US/press/mozilla1.0.html http://blog.mozilla.org/press/2002/06/mozilla-org-launches-mozilla-1-0/ [L,R=301]
RewriteRule ^/en-US/press/open-source-security.html http://blog.mozilla.org/press/2000/01/open-source-development-of-security-products-possible-worldwide-enhancing-security-and-privacy-for-e-commerce-and-communication/ [L,R=301]

# bug 868169
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?mobile/android-download\.html https://play.google.com/store/apps/details?id=org.mozilla.firefox [QSA,L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?mobile/android-download-beta\.html https://play.google.com/store/apps/details?id=org.mozilla.firefox_beta [QSA,L,R=301]

# bug 723267
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?projects/calendar(/?)$ /b/$1projects/calendar$2 [PT]

# bug 885799, 952429
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?projects/calendar/holidays.html$ /$1projects/calendar/holidays/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?projects/calendar/holidays(/?)$ /b/$1projects/calendar/holidays$2 [PT]
# So that current subscriptions will continue to work
RewriteRule ^/projects/calendar/caldata/(.*)$ /media/caldata/$1 [PT]

# Bug 981063, catch all for old calendar urls.
RewriteRule ^/projects/calendar/.+ /projects/calendar/ [L,R=301]

# bug 947890
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/latest/releasenotes(/?)$ /b/$1firefox/latest/releasenotes$2 [PT]

# bug 962307
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?gigabit(.*)$ /b/$1gigabit$2 [PT]

# bug 940555
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?press/speakerrequest(/?)$ /b/$1press/speakerrequest$2 [PT]

# bug 971244
RewriteRule ^/firefox/its-a-trap.html$ http://www.itisatrap.org/firefox/its-a-trap.html [L,R=301]
RewriteRule ^/firefox/its-an-attack.html$ http://www.itisatrap.org/firefox/its-an-attack.html [L,R=301]

# bug 979217
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox(/(?:\d+\.\d+\.?(?:\d+)?\.?(?:\d+)?(?:[a|b]?)(?:\d*)(?:pre)?(?:\d)?))?/tour(/?)$ /b/$1firefox$2/tour$3 [PT]

# bug 975156
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/desktop(/?.*)$ /b/$1firefox/desktop$2 [PT]

# Bug 986174
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/mobile/features(/?)$ /$1firefox/android/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/mobile/faq(/?)$ /$1firefox/android/faq/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/android(/?)$ /b/$1firefox/android$2 [PT]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/android/faq(/?)$ /b/$1firefox/android/faq$2 [PT]

# Bug 979527
RewriteCond %{HTTP_USER_AGENT} Firefox
RewriteCond %{HTTP_USER_AGENT} !(Camino|Iceweasel|SeaMonkey)
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/central(/?)$ https://support.mozilla.org/kb/get-started-firefox-overview-main-features [E=varyua:1,L,R=302]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/central(/?)$ /$1firefox/new/ [E=varyua:1,L,R=302]

# Bug 979670, 979531, 1003727, 979664, 979654, 979660
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/features(/?)$ /$1firefox/desktop/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/customize(/?)$ /$1firefox/desktop/customize/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/(?:performance|happy|speed|memory)/?$ /$1firefox/desktop/fast/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/security(/?)$ /$1firefox/desktop/trust/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/technology(/?)$ https://developer.mozilla.org/docs/Tools [L,R=301]

# Bug 920212
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/fx(/?)$ /$1firefox/new/ [L,R=301]

# Bug 1005674
RewriteCond %{QUERY_STRING} !^flv=(?:https?://videos\.(?:mozilla\.org|cdn\.mozilla\.net))?/\w+/
RewriteRule ^/media/flash/playerWithControls.swf - [F]

# Bug 896474
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?about(/?|/.+)$ /b/$1about$2 [PT]

# Bug 1040970
RewriteRule ^/mozillacareers$ https://wiki.mozilla.org/People/mozillacareers?utm_medium=redirect&utm_source=mozillacareers-vanity [L,R=301]

# Bug 1090468
RewriteRule ^/security/transition\.txt /media/security/transition.txt [L,PT]

# Bug 1026184
# TODO: enable this after testing and porting/archiving all pages
#RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?security(/?|/.+)$ /b/$1security$2 [PT]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?security(/?)$ /b/$1security$2 [PT]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?security/bug-bounty(.*)\.html$ /$1security/bug-bounty$2/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?security/bug-bounty(.*)$ /b/$1security/bug-bounty$2 [PT]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?security/advisories(.*)$ /b/$1security/advisories$2 [PT]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?security/announce(.*)$ /b/$1security/announce$2 [PT]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?security/known-vulnerabilities(.*)$ /b/$1security/known-vulnerabilities$2 [PT]

# Bug 1066629
RewriteRule ^/contribute\.json$ /b/contribute.json [PT]

# bug 876810
RewriteRule ^/hacking/commit-access-policy/$ /about/governance/policies/commit/access-policy/ [L,R=301]
RewriteRule ^/hacking/committer/$ /about/governance/policies/commit/ [L,R=301]
RewriteRule ^/hacking/committer/faq.html$ /about/governance/policies/commit/ [L,R=301]
RewriteRule ^/hacking/notification/$ /about/governance/policies/commit/ [L,R=301]

# bug 1071959
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/independent(/?.*)$ /b/$1firefox/independent$2 [PT]

# bug 1109132
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox(/(?:\d+\.\d+\.?(?:\d+)?\.?(?:\d+)?(?:[a|b]?)(?:\d*)(?:pre)?(?:\d)?))?/hello/start(/?)$ /b/$1firefox$2/hello/start$3 [PT]

# Bug 1110927
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/start/central\.html$ /$1firefox/new/ [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/panorama/$ https://support.mozilla.org/kb/tab-groups-organize-tabs [L,R=301]
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?firefox/sync/firstrun\.html$ /$1firefox/sync/ [L,R=301]

# bug 1088752
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?shapeoftheweb(/?.*)$ /b/$1shapeoftheweb$2 [PT]

# bug 1120658
RewriteRule ^/seamonkey-transition\.html$ http://www-archive.mozilla.org/seamonkey-transition.html [L,R=301]

# bug 1121082
RewriteRule ^/(\w{2,3}(?:-\w{2})?/)?hello/?$ /$1firefox/hello/ [L,R=301]

# bug 1116511
RewriteRule ^/(contributor-data/[a-z]+.json)$ /b/$1 [L,PT]
