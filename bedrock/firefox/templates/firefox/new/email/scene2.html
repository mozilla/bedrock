{# This Source Code Form is subject to the terms of the Mozilla Public
 # License, v. 2.0. If a copy of the MPL was not distributed with this
 # file, You can obtain one at http://mozilla.org/MPL/2.0/. -#}

{% extends "base-protocol.html" %}

{% block experiments %}
  {% if switch('firefox_download_scene2_email_experiment', ['en-US']) %}
    {{ js_bundle('firefox_download_scene2_email_experiment') }}
  {% endif %}
{% endblock %}

{% block canonical_urls %}
  {# the "scene 2" page should set canonical to the /firefox/new/ page to give that
     page the SEO weight of links directly to "scene 2".
     see https://github.com/mozilla/bedrock/pull/5463 #}
  <link rel="canonical" href="{{ settings.CANONICAL_URL }}/{{ LANG }}/firefox/new/">
{% endblock %}

{% block page_image %}{{ static('img/firefox/template/page-image.png') }}{% endblock %}
{% block page_favicon %}{{ static('img/firefox/favicon.ico') }}{% endblock %}
{% block page_favicon_large %}{{ static('img/firefox/favicon-196.png') }}{% endblock %}
{% block page_ios_icon %}{{ static('img/firefox/ios-icon-180.png') }}{% endblock %}

{% block page_og_url %}{{ settings.CANONICAL_URL }}/{{ LANG }}/firefox/new/{% endblock %}

{% block page_title %}{{ _('Download Firefox') }} — {{ _('Free Web Browser') }}{% endblock %}

{# All stylesheets are loaded in extrahead to serve legacy IE basic styles #}
{% block extrahead %}
  {{ super() }}
  {{ css_bundle('firefox_new_scene2_email') }}
{% endblock %}

{% block body_id %}firefox-new-scene2{% endblock %}

{% block string_data %}
  data-pixels="{% for pixel in settings.TRACKING_PIXELS %}{{ pixel }}{% if not loop.last %}::{% endif %}{% endfor %}"
{% endblock %}

{% block site_header %}{% endblock %}

{% if LANG == 'en-CA' %}
  {% set firefox_logo_title = 'Firefox (CA)' %}
  {% set mozilla_logo_title = 'Mozilla (CA)' %}
{% elif LANG == 'en-GB' %}
  {% set firefox_logo_title = 'Firefox (UK)' %}
  {% set mozilla_logo_title = 'Mozilla (UK)' %}
{% else %}
  {% set firefox_logo_title = 'Firefox' %}
  {% set mozilla_logo_title = 'Mozilla' %}
{% endif %}

{% block content %}
<div class="status">
  <div class="mzp-l-content mzp-t-firefox">
    {# fallback_url is replaced by the platform download link via JS, but if
      something fails the user should still get a link to a working download path. #}

    {% set id, fallback_url = 'direct-download-link', url('firefox.all') %}
    <p>
    {% trans %}
      Your download should begin automatically. Didn’t work? <a id="{{ id }}" href="{{ fallback_url }}">Try downloading again</a>.
    {% endtrans %}
    </p>
  </div>
</div>

<main class="main mzp-t-firefox mzp-t-dark">
  <div class="mzp-l-content">
    <div class="header-logos">
      <h2><a class="firefox" href="{{ url('firefox') }}" title="{{ firefox_logo_title }}">{{ high_res_img('logos/firefox/logo-quantum-wordmark-white.png', {'alt': firefox_logo_title, 'width': '133', 'height': '50'}) }}</a></h2>
      <h2><a class="mozilla" href="{{ url('mozorg.home') }}" title="{{ mozilla_logo_title }}"><img src="{{ static('img/logos/mozilla/wordmark-dark.svg')}}" alt="{{ mozilla_logo_title }}" width="101" height="34"></a></h2>
    </div>

    <div class="content-main">
      <div class="download-button-wrapper desktop" id="download-button-wrapper-desktop">
        {{ download_firefox(force_direct=true, dom_id='primary-download-button') }}
      </div>

      <h1 class="headline">
      {% block headline %}
        {{ _('Learn how to make Firefox even smarter, faster and more secure.') }}
      {% endblock %}
      </h1>
      <p class="tagline">{{ _('Get informative tips, tricks and product announcements delivered to your inbox.') }}</p>

      <div class="mzp-c-newsletter">
        {{ email_newsletter_form(
              protocol_component=True,
              include_title=False,
              submit_text=_('Sign up now'),
              email_label=_('Enter your email address'),
              email_placeholder=_('yourname@example.com'),
              details='<a href="%s" class="email-privacy-link">%s</a>'|format(url('privacy.email'), _('How will Mozilla use my email?'))|safe
        )}}
      </div>

      <aside class="email-privacy mzp-u-modal-content">
        <h3>{{ _('How will Mozilla use my email?') }}</h3>

        <p>
        {% trans
              manifesto=url('mozorg.about.manifesto'),
              principles=url('privacy.principles')
        %}
          Mozilla doesn’t just value your email privacy and security – it’s part of our <a href="{{ manifesto }}">Manifesto</a>: “Individuals’ security and privacy on the internet are fundamental and must not be treated as optional.” <a href="{{ principles }}">You can learn about our Data Privacy Principles here</a>.
        {% endtrans %}
        </p>

        <p><strong>{{ _('What we want you to know:') }}</strong></p>

        <ul class="prose mzp-u-list-styled">
          <li>{{ _('You don’t need to give us your email to download and use Firefox.') }}</li>
          <li>{{ _('We asked for your email because our research shows that people who receive an introductory experience do more and better with Firefox.') }}</li>
          <li>{{ _('Unless you’re subscribed to another Mozilla newsletter or list, you can expect a short email series designed to help you use Firefox to its full potential and occasional product announcements. That’s it.') }}</li>
          <li>{{ _('You can unsubscribe anytime, for any reason.') }}</li>
          <li>{{ _('We will not share, sell or use your email for any other purposes.') }}</li>
        </ul>
      </aside>

    </div>
  </div>
</main>
{% endblock %}

{% block js %}
  {% if switch('tracking-pixel') %}
    {{ js_bundle('firefox_new_pixel') }}
  {% endif %}
  {{ js_bundle('firefox_new_scene2_email') }}
{% endblock %}
